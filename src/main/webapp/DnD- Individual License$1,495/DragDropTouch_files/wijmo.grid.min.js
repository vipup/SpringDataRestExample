/*
    *
    * Wijmo Library 5.20172.328
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),wijmo;wijmo.culture.FlexGrid=window.wijmo.culture.FlexGrid||{groupHeaderFormat:'{name}: <b>{value}</b> ({count:n0} items)'},function(n){var t;(function(t){'use strict';var i,r;(function(n){n[n.None=0]="None";n[n.Column=1]="Column";n[n.Row=2]="Row";n[n.All=3]="All"})(i=t.HeadersVisibility||(t.HeadersVisibility={}));r=function(r){function u(u,f){var e=r.call(this,u,null,!0)||this,o,s;e._szClient=new n.Size(0,0);e._ptScrl=new n.Point(0,0);e._cellPadding=3;e._autoGenCols=!0;e._autoClipboard=!0;e._readOnly=!1;e._indent=14;e._autoSizeMode=t.AutoSizeMode.Both;e._hdrVis=i.All;e._alSorting=!0;e._alAddNew=!1;e._alDelete=!1;e._alResizing=t.AllowResizing.Columns;e._alDragging=t.AllowDragging.Columns;e._alMerging=t.AllowMerging.None;e._ssHdr=i.None;e._shSort=!0;e._shGroups=!0;e._shAlt=!0;e._shErr=!0;e._valEdt=!0;e._deferResizing=!1;e._pSel=!0;e._pOutline=!0;e._vt=0;e.itemsSourceChanged=new n.Event;e.scrollPositionChanged=new n.Event;e.selectionChanging=new n.Event;e.selectionChanged=new n.Event;e.loadingRows=new n.Event;e.loadedRows=new n.Event;e.updatingLayout=new n.Event;e.updatedLayout=new n.Event;e.resizingColumn=new n.Event;e.resizedColumn=new n.Event;e.autoSizingColumn=new n.Event;e.autoSizedColumn=new n.Event;e.draggingColumn=new n.Event;e.draggingColumnOver=new n.Event;e.draggedColumn=new n.Event;e.resizingRow=new n.Event;e.resizedRow=new n.Event;e.autoSizingRow=new n.Event;e.autoSizedRow=new n.Event;e.draggingRow=new n.Event;e.draggingRowOver=new n.Event;e.draggedRow=new n.Event;e.groupCollapsedChanging=new n.Event;e.groupCollapsedChanged=new n.Event;e.sortingColumn=new n.Event;e.sortedColumn=new n.Event;e.beginningEdit=new n.Event;e.prepareCellForEdit=new n.Event;e.cellEditEnding=new n.Event;e.cellEditEnded=new n.Event;e.rowEditStarting=new n.Event;e.rowEditStarted=new n.Event;e.rowEditEnding=new n.Event;e.rowEditEnded=new n.Event;e.rowAdded=new n.Event;e.deletingRow=new n.Event;e.deletedRow=new n.Event;e.copying=new n.Event;e.copied=new n.Event;e.pasting=new n.Event;e.pasted=new n.Event;e.pastingCell=new n.Event;e.pastedCell=new n.Event;e.formatItem=new n.Event;e.updatingView=new n.Event;e.updatedView=new n.Event;e._mappedColumns=null;o=e.hostElement;n.isIE()&&(o.style.borderRadius='0px');var h='tabindex',c=o.getAttribute(h),l=e.getTemplate();return e.applyTemplate('wj-control wj-flexgrid wj-content',l,{_root:'root',_eSz:'sz',_eCt:'cells',_fCt:'fcells',_eTL:'tl',_eBL:'bl',_eCHdr:'ch',_eRHdr:'rh',_eCFtr:'cf',_eTLCt:'tlcells',_eBLCt:'blcells',_eCHdrCt:'chcells',_eCFtrCt:'cfcells',_eRHdrCt:'rhcells',_eMarquee:'marquee',_eFocus:'focus'}),n.setAttribute(o,h,c),s=e._getDefaultRowHeight(),e.deferUpdate(function(){e._rows=new t.RowCollection(e,s);e._cols=new t.ColumnCollection(e,s*4);e._hdrRows=new t.RowCollection(e,s);e._hdrCols=new t.ColumnCollection(e,Math.round(s*1.25));e._ftrRows=new t.RowCollection(e,s);e._gpTL=new t.GridPanel(e,t.CellType.TopLeft,e._hdrRows,e._hdrCols,e._eTLCt);e._gpCHdr=new t.GridPanel(e,t.CellType.ColumnHeader,e._hdrRows,e._cols,e._eCHdrCt);e._gpRHdr=new t.GridPanel(e,t.CellType.RowHeader,e._rows,e._hdrCols,e._eRHdrCt);e._gpCells=new t.GridPanel(e,t.CellType.Cell,e._rows,e._cols,e._eCt);e._gpBL=new t.GridPanel(e,t.CellType.BottomLeft,e._ftrRows,e._hdrCols,e._eBLCt);e._gpCFtr=new t.GridPanel(e,t.CellType.ColumnFooter,e._ftrRows,e._cols,e._eCFtrCt);e._hdrRows.push(new t.Row);e._hdrCols.push(new t.Column);e._hdrCols[0].align='center';e._cf=new t.CellFactory;e._keyHdl=new t._KeyboardHandler(e);e._mouseHdl=new t._MouseHandler(e);e._edtHdl=new t._EditHandler(e);e._selHdl=new t._SelectionHandler(e);e._addHdl=new t._AddNewHandler(e);e._mrgMgr=new t.MergeManager(e);e._bndSortConverter=e._sortConverter.bind(e);e._bndScroll=e._scroll.bind(e);e.cells.hostElement.setAttribute('role','grid');e.selectionMode=t.SelectionMode.CellRange;e.initialize(f)}),e.addEventListener(e._root,'scroll',function(){e._updateScrollPosition()&&(e.finishEditing(),e._updateContent(!0))}),e.addEventListener(o,'focus',function(n){if(o.tabIndex>-1){var t=n.target;if(t instanceof HTMLElement&&t.tabIndex<0){e._setFocus(!0);return}}},!0),e}return __extends(u,r),u.prototype._handleResize=function(){this._rcBounds=null;r.prototype._handleResize.call(this)},Object.defineProperty(u.prototype,"headersVisibility",{get:function(){return this._hdrVis},set:function(t){t!=this._hdrVis&&(this._hdrVis=n.asEnum(t,i),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"stickyHeaders",{get:function(){return this._stickyHdr},set:function(t){t!=this._stickyHdr&&(this._stickyHdr=n.asBoolean(t),this._updateStickyHeaders(),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"preserveSelectedState",{get:function(){return this._pSel},set:function(t){this._pSel=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"preserveOutlineState",{get:function(){return this._pOutline},set:function(t){this._pOutline=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"_virtualizationThreshold",{get:function(){return this._vt},set:function(t){this._vt=n.asNumber(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"autoGenerateColumns",{get:function(){return this._autoGenCols},set:function(t){this._autoGenCols=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"autoClipboard",{get:function(){return this._autoClipboard},set:function(t){this._autoClipboard=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"columnLayout",{get:function(){for(var c,o,r,i,f,s=u._getSerializableProperties(t.Column),l=new t.Column,h=[],e=0;e<this.columns.length;e++){for(c=this.columns[e],o={},r=0;r<s.length;r++)i=s[r],f=c[i],f!=l[i]&&n.isPrimitive(f)&&i!='size'&&(o[i]=f);h.push(o)}return JSON.stringify({columns:h})},set:function(t){var i=JSON.parse(n.asString(t));if(!i||i.columns==null)throw'Invalid columnLayout data.';this.columns.clear();this.initialize(i)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(t){t!=this._readOnly&&(this._readOnly=n.asBoolean(t),this.finishEditing(),this.invalidate(!0),this._addHdl.updateNewRowTemplate(),n.toggleClass(this.hostElement,'wj-state-readonly',this.isReadOnly),this._setAria('readonly',this.isReadOnly?'true':null))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"imeEnabled",{get:function(){return this._imeHdl!=null},set:function(n){n!=this.imeEnabled&&(this._imeHdl&&(this._imeHdl.dispose(),this._imeHdl=null),n&&(this._imeHdl=new t._ImeHandler(this)))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowResizing",{get:function(){return this._alResizing},set:function(i){this._alResizing=n.asEnum(i,t.AllowResizing)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"deferResizing",{get:function(){return this._deferResizing},set:function(t){this._deferResizing=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"autoSizeMode",{get:function(){return this._autoSizeMode},set:function(i){this._autoSizeMode=n.asEnum(i,t.AutoSizeMode)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowSorting",{get:function(){return this._alSorting},set:function(t){this._alSorting=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowAddNew",{get:function(){return this._alAddNew},set:function(t){t!=this._alAddNew&&(this._alAddNew=n.asBoolean(t),this._addHdl.updateNewRowTemplate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"newRowAtTop",{get:function(){return this._addHdl.newRowAtTop},set:function(t){this._addHdl.newRowAtTop=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowDelete",{get:function(){return this._alDelete},set:function(t){t!=this._alDelete&&(this._alDelete=n.asBoolean(t))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowMerging",{get:function(){return this._alMerging},set:function(i){i!=this._alMerging&&(this._alMerging=n.asEnum(i,t.AllowMerging),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showSelectedHeaders",{get:function(){return this._ssHdr},set:function(t){t!=this._ssHdr&&(this._ssHdr=n.asEnum(t,i),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showMarquee",{get:function(){return!this._eMarquee.style.display},set:function(t){if(t!=this.showMarquee){var i=this._eMarquee.style;i.visibility='collapse';i.display=n.asBoolean(t)?'':'none';this.invalidate()}},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showSort",{get:function(){return this._shSort},set:function(t){t!=this._shSort&&(this._shSort=n.asBoolean(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showGroups",{get:function(){return this._shGroups},set:function(t){t!=this._shGroups&&(this._shGroups=n.asBoolean(t),this._bindGrid(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showAlternatingRows",{get:function(){return this._shAlt},set:function(t){t!=this._shAlt&&(this._shAlt=n.asBoolean(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showErrors",{get:function(){return this._shErr},set:function(t){t!=this._shErr&&(this._shErr=n.asBoolean(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"itemValidator",{get:function(){return this._itemValidator},set:function(t){t!=this.itemValidator&&(this._itemValidator=n.asFunction(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"validateEdits",{get:function(){return this._valEdt},set:function(t){this._valEdt=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"groupHeaderFormat",{get:function(){return this._gHdrFmt},set:function(t){t!=this._gHdrFmt&&(this._gHdrFmt=n.asString(t),this._bindGrid(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowDragging",{get:function(){return this._alDragging},set:function(i){i!=this._alDragging&&(this._alDragging=n.asEnum(i,t.AllowDragging),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"itemsSource",{get:function(){return this._items},set:function(t){var i;t!=this._items&&(this._cv&&(i=n.tryCast(this._cv,n.collections.CollectionView),i&&i.sortConverter==this._bndSortConverter&&(i.sortConverter=null),this._cv.currentChanged.removeHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.removeHandler(this._cvCollectionChanged,this),this._cv=null),this._items=t,this._cv=this._getCollectionView(t),this._lastCount=0,this._cv&&(this._cv.currentChanged.addHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.addHandler(this._cvCollectionChanged,this),i=n.tryCast(this._cv,n.collections.CollectionView),i&&!i.sortConverter&&(i.sortConverter=this._bndSortConverter)),this._bindGrid(!0),this.onItemsSourceChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"editableCollectionView",{get:function(){return n.tryCast(this._cv,'IEditableCollectionView')},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"childItemsPath",{get:function(){return this._childItemsPath},set:function(t){t!=this._childItemsPath&&(n.assert(t==null||n.isArray(t)||n.isString(t),'childItemsPath should be an array or a string.'),this._childItemsPath=t,this._bindGrid(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"rowHeaderPath",{get:function(){return this._rowHdrPath?this._rowHdrPath.path:null},set:function(t){t!=this.rowHeaderPath&&(t=n.asString(t),this._rowHdrPath=t?new n.Binding(t):null,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"cells",{get:function(){return this._gpCells},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"columnHeaders",{get:function(){return this._gpCHdr},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"columnFooters",{get:function(){return this._gpCFtr},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"rowHeaders",{get:function(){return this._gpRHdr},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"topLeftCells",{get:function(){return this._gpTL},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"bottomLeftCells",{get:function(){return this._gpBL},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),u.prototype.getColumn=function(n){return this.columns.getColumn(n)},Object.defineProperty(u.prototype,"frozenRows",{get:function(){return this.rows.frozen},set:function(n){this.rows.frozen=n},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"frozenColumns",{get:function(){return this.columns.frozen},set:function(n){this.columns.frozen=n},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"cloneFrozenCells",{get:function(){return this._fzClone},set:function(t){t!=this.cloneFrozenCells&&(this._fzClone=n.asBoolean(t,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"sortRowIndex",{get:function(){return this._sortRowIndex},set:function(t){t!=this._sortRowIndex&&(this._sortRowIndex=n.asNumber(t,!0),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"scrollPosition",{get:function(){return this._ptScrl.clone()},set:function(n){var t=this._root,i=-n.x;if(this.rightToLeft)switch(u._getRtlMode()){case'rev':i=t.scrollWidth-t.clientWidth+n.x;break;case'neg':i=n.x;break;default:i=-n.x}t.scrollLeft=i;t.scrollTop=-n.y},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"clientSize",{get:function(){return this._szClient},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"controlRect",{get:function(){return this._rcBounds||(this._rcBounds=n.getElementRect(this._root)),this._rcBounds},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"scrollSize",{get:function(){return new n.Size(this._gpCells.width,this._heightBrowser)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"viewRange",{get:function(){return this._gpCells.viewRange},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"cellFactory",{get:function(){return this._cf},set:function(i){i!=this._cf&&(this._cf=n.asType(i,t.CellFactory,!1),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(t){t!=this._itemFormatter&&(this._itemFormatter=n.asFunction(t),this.invalidate())},enumerable:!0,configurable:!0}),u.prototype.canEditCell=function(n,t){return this._edtHdl._allowEditing(n,t)},u.prototype.getCellData=function(n,t,i){return this.cells.getCellData(n,t,i)},u.prototype.getCellBoundingRect=function(n,t,i){return this.cells.getCellBoundingRect(n,t,i)},u.prototype.setCellData=function(n,t,i,r,u){return r===void 0&&(r=!0),u===void 0&&(u=!0),this.cells.setCellData(n,t,i,r,u)},u.prototype.hitTest=function(i,r){return n.isNumber(i)&&n.isNumber(r)&&(i=new n.Point(i,r)),new t.HitTestInfo(this,i)},u.prototype.getClipString=function(n){return this._edtHdl.getClipString(n)},u.prototype.setClipString=function(n,t){this._edtHdl.setClipString(n,t)},u.prototype.focus=function(){this._setFocus(!1)},u.prototype.dispose=function(){this.finishEditing(!0);this.itemsSource=null;r.prototype.dispose.call(this)},u.prototype.refresh=function(n){n===void 0&&(n=!0);r.prototype.refresh.call(this,n);this.finishEditing();n&&(this._updateColumnTypes(),this.scrollPosition=this._ptScrl);this.refreshCells(n)},u.prototype.refreshCells=function(n,t,i){this.isUpdating||(n?this._updateLayout():this._updateContent(t,i))},u.prototype.autoSizeColumn=function(n,t,i){t===void 0&&(t=!1);i===void 0&&(i=4);this.autoSizeColumns(n,n,t,i)},u.prototype.autoSizeColumns=function(i,r,f,e){var s=this;f===void 0&&(f=!1);e===void 0&&(e=4);var h=0,l=f?this.topLeftCells:this.columnHeaders,o=f?this.rowHeaders:this.cells,c=this.viewRange;i=i==null?0:n.asInt(i);r=r==null?o.columns.length-1:n.asInt(r);n.asBoolean(f);n.asNumber(e);c.row=Math.max(0,c.row-1e3);c.row2=Math.min(c.row2+1e3,this.rows.length-1);this.finishEditing()&&this.deferUpdate(function(){var a,v,f,y;for(n.setCss(s._eCt,{width:s._gpCells.width}),a=document.createElement('div'),a.setAttribute(u._WJS_MEASURE,'true'),a.style.visibility='hidden',o.hostElement.parentElement.appendChild(a),v=i;v<=r&&v>-1&&v<o.columns.length;v++){if(h=0,s.autoSizeMode&t.AutoSizeMode.Headers)for(f=0;f<l.rows.length;f++)l.rows[f].isVisible&&(y=s._getDesiredWidth(l,f,v,a),h=Math.max(h,y));if(s.autoSizeMode&t.AutoSizeMode.Cells)for(f=c.row;f<=c.row2&&f>-1&&f<o.rows.length;f++)o.rows[f].isVisible&&(y=s._getDesiredWidth(o,f,v,a),h=Math.max(h,y));o.columns[v].width=h+e+2}a.parentElement.removeChild(a)})},u.prototype.autoSizeRow=function(n,t,i){t===void 0&&(t=!1);i===void 0&&(i=0);this.autoSizeRows(n,n,t,i)},u.prototype.autoSizeRows=function(i,r,f,e){var s=this;f===void 0&&(f=!1);e===void 0&&(e=0);var h=0,c=f?this.topLeftCells:this.rowHeaders,o=f?this.columnHeaders:this.cells;f=n.asBoolean(f);e=n.asNumber(e);i=i==null?0:n.asInt(i);r=r==null?o.rows.length-1:n.asInt(r);this.finishEditing()&&this.deferUpdate(function(){var l,a,f,v;for(n.setCss(s._eCt,{width:s._gpCells.width}),l=document.createElement('div'),l.setAttribute(u._WJS_MEASURE,'true'),l.style.visibility='hidden',o.hostElement.appendChild(l),a=i;a<=r&&a>-1&&a<o.rows.length;a++){if(h=0,s.autoSizeMode&t.AutoSizeMode.Headers)for(f=0;f<c.columns.length;f++)c.columns[f].renderSize>0&&(v=s._getDesiredHeight(c,a,f,l),h=Math.max(h,v));if(s.autoSizeMode&t.AutoSizeMode.Cells)for(f=0;f<o.columns.length;f++)o.columns[f].renderSize>0&&(v=s._getDesiredHeight(o,a,f,l),h=Math.max(h,v));o.rows[a].height=h+e}l.parentElement.removeChild(l)})},Object.defineProperty(u.prototype,"treeIndent",{get:function(){return this._indent},set:function(t){t!=this._indent&&(this._indent=n.asNumber(t,!1,!0),this.columns.onCollectionChanged())},enumerable:!0,configurable:!0}),u.prototype.collapseGroupsToLevel=function(i){if(this.finishEditing()){var r=this.rows;r.deferUpdate(function(){for(var f,u=0;u<r.length;u++)f=n.tryCast(r[u],t.GroupRow),f&&(f.isCollapsed=f.level>=i)})}},Object.defineProperty(u.prototype,"selectionMode",{get:function(){return this._selHdl.selectionMode},set:function(i){i!=this.selectionMode&&(this._selHdl.selectionMode=n.asEnum(i,t.SelectionMode),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"selection",{get:function(){return this._selHdl.selection.clone()},set:function(n){this._selHdl.selection=n},enumerable:!0,configurable:!0}),u.prototype.select=function(n,t){t===void 0&&(t=!0);this._selHdl.select(n,t)},u.prototype.getSelectedState=function(n,t){return this.cells.getSelectedState(n,t,null)},Object.defineProperty(u.prototype,"selectedRows",{get:function(){var i=[],r,n;if(this.selectionMode==t.SelectionMode.ListBox)for(n=0;n<this.rows.length;n++)this.rows[n].isSelected&&i.push(this.rows[n]);else if(this.rows.length)for(r=this.selection,n=r.topRow;n>-1&&n<=r.bottomRow;n++)i.push(this.rows[n]);return i},set:function(i){var r=this;n.assert(this.selectionMode==t.SelectionMode.ListBox,'This property can be set only in ListBox mode.');i=n.asArray(i);this.deferUpdate(function(){for(var u,f,n=0,t=!0;n<r.rows.length;n++)u=r.rows[n],f=i&&i.indexOf(u)>-1,f&&t&&(t=!1,r.select(n,r.selection.col)),u.isSelected=f})},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"selectedItems",{get:function(){for(var n=this.selectedRows,t=0;t<n.length;t++)n[t]=n[t].dataItem;return n},set:function(i){var r=this;n.assert(this.selectionMode==t.SelectionMode.ListBox,'This property can be set only in ListBox mode.');i=n.asArray(i);this.deferUpdate(function(){for(var u,f,n=0,t=!0;n<r.rows.length;n++)u=r.rows[n],f=i&&i.indexOf(u.dataItem)>-1,f&&t&&(t=!1,r.select(n,r.selection.col)),u.isSelected=f})},enumerable:!0,configurable:!0}),u.prototype.scrollIntoView=function(t,i){var u,h;this._maxOffsetY==null&&this._updateLayout();var r=this.scrollPosition,c=this._szClient.width,f=this._szClient.height-this._gpCFtr.rows.getTotalSize(),e=this.cells._getFrozenPos();if(t=n.asInt(t),t>-1&&t<this._rows.length&&t>=this._rows.frozen){var s=this._rows[t],a=this.cells.height>f?Math.round(s.pos/(this.cells.height-f)*100)/100:0,v=Math.round(this._maxOffsetY*a),o=s.pos-v,l=o+s.renderSize-1;l>f-r.y&&(r.y=Math.max(-o,f-l));o-e.y<-r.y&&(r.y=-(o-e.y))}return(i=n.asInt(i),i>-1&&i<this._cols.length&&i>=this._cols.frozen&&(u=this._cols[i],h=u.pos+u.renderSize-1,h>-r.x+c&&(r.x=Math.max(-u.pos,c-h)),u.pos-e.x<-r.x&&(r.x=-(u.pos-e.x))),!r.equals(this._ptScrl))?(this.scrollPosition=r,!0):!1},u.prototype.isRangeValid=function(n){return n.isValid&&n.bottomRow<this.rows.length&&n.rightCol<this.columns.length},u.prototype.startEditing=function(n,t,i,r){return n===void 0&&(n=!0),this._edtHdl.startEditing(n,t,i,r)},u.prototype.finishEditing=function(n){return n===void 0&&(n=!1),this._edtHdl.finishEditing(n)},Object.defineProperty(u.prototype,"activeEditor",{get:function(){return this._edtHdl.activeEditor},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"editRange",{get:function(){return this._edtHdl.editRange},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"mergeManager",{get:function(){return this._mrgMgr},set:function(i){i!=this._mrgMgr&&(this._mrgMgr=n.asType(i,t.MergeManager,!0),this.invalidate())},enumerable:!0,configurable:!0}),u.prototype.getMergedRange=function(n,t,i,r){return r===void 0&&(r=!0),this._mrgMgr?this._mrgMgr.getMergedRange(n,t,i,r):null},Object.defineProperty(u.prototype,"keyActionTab",{get:function(){return this._keyHdl._kaTab},set:function(i){this._keyHdl._kaTab=n.asEnum(i,t.KeyAction)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"keyActionEnter",{get:function(){return this._keyHdl._kaEnter},set:function(i){this._keyHdl._kaEnter=n.asEnum(i,t.KeyAction)},enumerable:!0,configurable:!0}),u.prototype.onItemsSourceChanged=function(n){this.itemsSourceChanged.raise(this,n)},u.prototype.onScrollPositionChanged=function(n){this.scrollPositionChanged.raise(this,n)},u.prototype.onSelectionChanging=function(n){return this.selectionChanging.raise(this,n),!n.cancel},u.prototype.onSelectionChanged=function(n){this.selectionChanged.raise(this,n)},u.prototype.onLoadingRows=function(n){return this.loadingRows.raise(this,n),!n.cancel},u.prototype.onLoadedRows=function(n){this.loadedRows.raise(this,n)},u.prototype.onUpdatingLayout=function(n){return this.updatingLayout.raise(this,n),!n.cancel},u.prototype.onUpdatedLayout=function(n){this.updatedLayout.raise(this,n)},u.prototype.onResizingColumn=function(n){return this.resizingColumn.raise(this,n),!n.cancel},u.prototype.onResizedColumn=function(n){this.resizedColumn.raise(this,n)},u.prototype.onAutoSizingColumn=function(n){return this.autoSizingColumn.raise(this,n),!n.cancel},u.prototype.onAutoSizedColumn=function(n){this.autoSizedColumn.raise(this,n)},u.prototype.onDraggingColumn=function(n){return this.draggingColumn.raise(this,n),!n.cancel},u.prototype.onDraggingColumnOver=function(n){return this.draggingColumnOver.raise(this,n),!n.cancel},u.prototype.onDraggedColumn=function(n){this.draggedColumn.raise(this,n)},u.prototype.onResizingRow=function(n){return this.resizingRow.raise(this,n),!n.cancel},u.prototype.onResizedRow=function(n){this.resizedRow.raise(this,n)},u.prototype.onAutoSizingRow=function(n){return this.autoSizingRow.raise(this,n),!n.cancel},u.prototype.onAutoSizedRow=function(n){this.autoSizedRow.raise(this,n)},u.prototype.onDraggingRow=function(n){return this.draggingRow.raise(this,n),!n.cancel},u.prototype.onDraggingRowOver=function(n){return this.draggingRowOver.raise(this,n),!n.cancel},u.prototype.onDraggedRow=function(n){this.draggedRow.raise(this,n)},u.prototype.onGroupCollapsedChanging=function(n){return this.groupCollapsedChanging.raise(this,n),!n.cancel},u.prototype.onGroupCollapsedChanged=function(n){this.groupCollapsedChanged.raise(this,n)},u.prototype.onSortingColumn=function(n){return this.sortingColumn.raise(this,n),!n.cancel},u.prototype.onSortedColumn=function(n){this.sortedColumn.raise(this,n)},u.prototype.onBeginningEdit=function(n){return this.beginningEdit.raise(this,n),!n.cancel},u.prototype.onPrepareCellForEdit=function(n){this.prepareCellForEdit.raise(this,n)},u.prototype.onCellEditEnding=function(n){return this.cellEditEnding.raise(this,n),!n.cancel&&!n.stayInEditMode},u.prototype.onCellEditEnded=function(n){this.cellEditEnded.raise(this,n)},u.prototype.onRowEditStarting=function(n){this.rowEditStarting.raise(this,n)},u.prototype.onRowEditStarted=function(n){this.rowEditStarted.raise(this,n)},u.prototype.onRowEditEnding=function(n){this.rowEditEnding.raise(this,n)},u.prototype.onRowEditEnded=function(n){this.rowEditEnded.raise(this,n)},u.prototype.onRowAdded=function(n){this.rowAdded.raise(this,n)},u.prototype.onDeletingRow=function(n){return this.deletingRow.raise(this,n),!n.cancel},u.prototype.onDeletedRow=function(n){this.deletedRow.raise(this,n)},u.prototype.onCopying=function(n){return this.copying.raise(this,n),!n.cancel},u.prototype.onCopied=function(n){this.copied.raise(this,n)},u.prototype.onPasting=function(n){return this.pasting.raise(this,n),!n.cancel},u.prototype.onPasted=function(n){this.pasted.raise(this,n)},u.prototype.onPastingCell=function(n){return this.pastingCell.raise(this,n),!n.cancel},u.prototype.onPastedCell=function(n){this.pastedCell.raise(this,n)},u.prototype.onFormatItem=function(n){this.formatItem.raise(this,n)},u.prototype.onUpdatingView=function(n){return this.updatingView.raise(this,n),!n.cancel},u.prototype.onUpdatedView=function(n){this.updatedView.raise(this,n)},u.prototype._getShowErrors=function(){if(this.showErrors){if(n.isFunction(this.itemValidator))return!0;var t=this.collectionView,i=t?t.getError:null;if(n.isFunction(i))return!0}return!1},u.prototype._getError=function(t,i,r){var f,e,o,h,s,u;if(n.isFunction(this.itemValidator)){if(t==this.cells)return this.itemValidator(i,r);if(t==this.rowHeaders)for(r=0;r<this.columns.length;r++)if(u=this.itemValidator(i,r),u)return u}if(f=this.collectionView,e=f?f.getError:null,f&&n.isFunction(e)&&(o=t.rows[i].dataItem,o)){if(t==this.cells)return s=this._getBindingColumn(t,i,this.columns[r]),e(o,s.binding);if(t==this.rowHeaders)for(h=0;h<this.columns.length;h++)if(s=this._getBindingColumn(t,i,this.columns[h]),u=e(o,s.binding),u)return u}return null},u.prototype._setAria=function(t,i){n.setAttribute(this.cells.hostElement,'aria-'+t,i)},u.prototype._setFocus=function(t){var r,u,f;if(this.hostElement&&(t||!this.containsFocus())){if(r=n.getActiveElement(),u='tabindex',this.activeEditor)n.contains(this.activeEditor,r)||(this.activeEditor.focus(),this._eFocus.removeAttribute(u));else if(this._activeCell){if(!n.contains(this._activeCell,r)){var e=this.scrollPosition,i=this._activeCell.style,o=i.width,s=i.height;i.width=i.height='0';this._activeCell.tabIndex=0;this._activeCell.focus();i.width=o;i.height=s;this.scrollPosition=e;f=this.hostElement;f.scrollTop=f.scrollLeft=0;this._eFocus.removeAttribute(u)}}else n.contains(this._eFocus,r)||(this._eFocus.tabIndex=0,this._eFocus.focus());this.containsFocus()||(this._eFocus.tabIndex=0,this._eFocus.focus())}},u.prototype._getDefaultRowHeight=function(){var f=this.hostElement,t=document.body,i=null,r,e,u;if(t&&!n.contains(t,f)){for(r=f;r;r=r.parentElement)i=r;i&&t.appendChild(i)}return e=n.createElement('<div class="wj-cell">123</div>',f),u=e.scrollHeight+2,f.removeChild(e),i&&t.removeChild(i),(u<=6||isNaN(u)||!t)&&(u=28),u},u.prototype._getCollectionView=function(t){return n.asCollectionView(t)},u.prototype._getDesiredWidth=function(n,t,i,r){var u=this.getMergedRange(n,t,i),f;return this.cellFactory.updateCell(n,t,i,r,u),r.style.width='',f=r.offsetWidth,u&&u.columnSpan>1?f/u.columnSpan:f},u.prototype._getDesiredHeight=function(n,t,i,r){var u=this.getMergedRange(n,t,i),f;return this.cellFactory.updateCell(n,t,i,r,u),r.style.height='',f=r.offsetHeight,u&&u.rowSpan>1?f/u.rowSpan:f},u.prototype._getSortRowIndex=function(){return this._sortRowIndex!=null?this._sortRowIndex:this.columnHeaders.rows.length-1},u.prototype._sortConverter=function(n,t,i,r){var u,o,f,e;if(r){if(this._mappedColumns=null,this.collectionView)for(o=this.collectionView.sortDescriptions,f=0;f<o.length;f++)u=this.getColumn(o[f].property),u&&u.dataMap&&(this._mappedColumns||(this._mappedColumns={}),this._mappedColumns[u.binding]=u.dataMap);this._mouseHdl._htDown&&this._mouseHdl._htDown.col>-1&&(u=this.columns[this._mouseHdl._htDown.col],this._mappedColumns&&u.dataMap&&(this._mappedColumns[u.binding]=u.dataMap))}return this._mappedColumns&&(e=this._mappedColumns[n.property],e&&e.sortByDisplayValues&&(i=e.getDisplayValue(i))),i},u.prototype._bindGrid=function(i){var r=this,u;this.deferUpdate(function(){var f,s,h,e,o,c,l,u;if(r._lastCount==0&&r._cv&&r._cv.items&&r._cv.items.length&&(i=!0),f=[],r.preserveSelectedState&&r.selectionMode==t.SelectionMode.ListBox&&!r.childItemsPath)for(u=0;u<r.rows.length;u++)s=r.rows[u],s.isSelected&&s.dataItem&&f.push(s.dataItem);if(r.preserveOutlineState&&n.isFunction(window.Map)&&r.rows.maxGroupLevel>-1)for(h=new Map,u=0;u<r.rows.length;u++)e=r.rows[u],e instanceof t.GroupRow&&e.isCollapsed&&e.dataItem&&(o=e.dataItem,o instanceof n.collections.CollectionViewGroup&&(o=o._path),h.set(o,!0));if(i&&r.columns.deferUpdate(function(){r._bindColumns()}),r.rows.deferUpdate(function(){r._bindRows()}),c=0,f.length)for(u=0;u<r.rows.length&&c<f.length;u++)f.indexOf(r.rows[u].dataItem)>-1&&(r.rows[u].isSelected=!0,c++);if(r.selectionMode==t.SelectionMode.ListBox&&c==0)for(l=r.selection,u=l.topRow;u<=l.bottomRow&&u>-1&&u<r.rows.length;u++)r.rows[u].isSelected=!0;h&&r.rows.deferUpdate(function(){for(var f,i,u=0;u<r.rows.length;u++)f=r.rows[u],f instanceof t.GroupRow&&(i=f.dataItem,i instanceof n.collections.CollectionViewGroup&&(i=i._path),h.get(i)&&(f.isCollapsed=!0))});!r._lastCount&&r._cv&&r._cv.items&&(r._lastCount=r._cv.items.length)});this.rows.length||(u=this._selHdl.selection,u.row=u.row2=-1);this.collectionView&&this._cvCurrentChanged(this.collectionView,n.EventArgs.empty)},u.prototype._cvCollectionChanged=function(i,r){var u,f;if(this.autoGenerateColumns&&this.columns.length==0){this._bindGrid(!0);return}if(this.childItemsPath&&r.action!=n.collections.NotifyCollectionChangedAction.Change){this._bindGrid(!1);return}switch(r.action){case n.collections.NotifyCollectionChangedAction.Change:this.invalidate();return;case n.collections.NotifyCollectionChangedAction.Add:if(r.index==this.collectionView.items.length-1){u=this.rows.length;this.rows[u-1]instanceof t._NewRowTemplate&&u--;this.rows.insert(u,new t.Row(r.item));return}n.assert(!1,'added item should be the last one.');break;case n.collections.NotifyCollectionChangedAction.Remove:if(f=this._findRow(r.item),f>-1){this.rows.removeAt(f);this._cvCurrentChanged(i,r);return}n.assert(!1,'removed item not found in grid.')}this._bindGrid(!1)},u.prototype._cvCurrentChanged=function(){var i,r,u;this.collectionView&&this.selectionMode!=t.SelectionMode.None&&(i=this.selection,r=i.row>-1&&i.row<this.rows.length?this.rows[i.row].dataItem:null,r instanceof n.collections.CollectionViewGroup&&(r=null),r!=this.collectionView.currentItem&&(this.childItemsPath&&this.editableCollectionView&&this.editableCollectionView.currentAddItem||(u=this._getRowIndex(this.collectionView.currentPosition),u==i.row&&this.childItemsPath||(i.row=i.row2=u,this.select(i)))))},u.prototype._getRowIndex=function(n){var u,i,r;if(this.collectionView){if(n>-1){for(u=this.collectionView.items[n];n<this.rows.length;n++)if(this.rows[n].dataItem===u)return n;return-1}return this.rows.length==1&&this.rows[0]instanceof t._NewRowTemplate?0:(i=this.selection.row,r=i>-1?this.rows[i]:null,r&&(r instanceof t.GroupRow||r.dataItem==null)?i:-1)}return this.selection.row},u.prototype._getCvIndex=function(n){if(n>-1&&this.collectionView){var t=this.rows[n].dataItem;for(n=Math.min(n,this.collectionView.items.length);n>-1;n--)if(this.collectionView.items[n]===t)return n}return-1},u.prototype._findRow=function(n){for(var t=0;t<this.rows.length;t++)if(this.rows[t].dataItem==n)return t;return-1},u.prototype._updateLayout=function(){var w=new n.CancelEventArgs,l,o,a,h,p,s;if(this.onUpdatingLayout(w)){var t=this._hdrVis&i.Row?this._hdrCols.getTotalSize():0,r=this._hdrVis&i.Column?this._hdrRows.getTotalSize():0,e=this._ftrRows.getTotalSize(),c=this._rows.getTotalSize()+e;c<1&&(c=1);this._heightBrowser=Math.min(c,u._getMaxSupportedCssHeight());this._maxOffsetY=Math.max(0,c-this._heightBrowser);this.cells.hostElement&&(l=n.createElement('<div class="wj-cell"></div>',this.cells.hostElement),s=getComputedStyle(l),this._cellPadding=parseInt(this.rightToLeft?s.paddingRight:s.paddingLeft),l.parentElement.removeChild(l));o=this._heightBrowser+r-e;this.rightToLeft?(n.setCss(this._eTL,{right:0,top:0,width:t,height:r}),n.setCss(this._eCHdr,{right:t,top:0,height:r}),n.setCss(this._eRHdr,{right:0,top:r,width:t}),n.setCss(this._eCt,{right:t,top:r,width:this._gpCells.width,height:this._heightBrowser}),n.setCss(this._fCt,{right:t,top:r}),n.setCss(this._eBL,{right:0,top:o,width:t,height:e}),n.setCss(this._eCFtr,{right:t,top:o,height:e})):(n.setCss(this._eTL,{left:0,top:0,width:t,height:r}),n.setCss(this._eCHdr,{left:t,top:0,height:r}),n.setCss(this._eRHdr,{left:0,top:r,width:t}),n.setCss(this._eCt,{left:t,top:r,width:this._gpCells.width,height:this._heightBrowser}),n.setCss(this._fCt,{left:t,top:r}),n.setCss(this._eBL,{left:0,top:o,width:t,height:e}),n.setCss(this._eCFtr,{left:t,top:o,height:e}));this._stickyHdr&&this._updateStickyHeaders();n.setCss([this._eTL,this._eBL,this._eCHdr,this._eCFtr,this._eRHdr,this._eMarquee],{zIndex:this.frozenRows||this.frozenColumns?'3':''});var f=this._root,v=f.offsetWidth-f.clientWidth,y=f.offsetHeight-f.clientHeight;n.setCss(this._eSz,{width:t+v+this._gpCells.width,height:r+y+this._heightBrowser});a=null;this.columns._updateStarSizes(f.clientWidth-t)&&(a=f.clientWidth,n.setCss(this._eCt,{width:this._gpCells.width}));this._szClient=new n.Size(f.clientWidth-t,f.clientHeight-r);this._rcBounds=null;this._updateScrollHandler();this._updateContent(!1);v=f.offsetWidth-f.clientWidth;y=f.offsetHeight-f.clientHeight;n.setCss(this._eSz,{width:t+v+this._gpCells.width,height:r+y+this._heightBrowser});h=this.hostElement;h&&(p=h.offsetHeight+'px',s=getComputedStyle(h),s.maxHeight==p&&s.boxSizing!='content-box'&&(h.style.height=p));this._szClient=new n.Size(f.clientWidth-t,f.clientHeight-r);a&&a!=f.clientWidth&&this.columns._updateStarSizes(f.clientWidth-t)&&(n.setCss(this._eCt,{width:this._gpCells.width}),this._updateContent(!1));n.setCss([this._eCHdr,this._eCFtr,this._fCt],{width:this._szClient.width});n.setCss([this._eRHdr,this._fCt],{height:this._szClient.height});e&&(o=Math.min(o,this._szClient.height+r-e),n.setCss([this._eBL,this._eCFtr],{top:o}));this.onUpdatedLayout(w)}},u.prototype._updateStickyHeaders=function(){var r=!1,o=0,f,t,i,e;if(this._stickyHdr){for(f=0,t=null,i=this.hostElement;i;i=i.parentElement)e=i.getBoundingClientRect(),t==null&&(t=e.top),f=Math.max(f,e.top);t=Math.max(0,f-t-1);o=-t;r=t>0}this._eTL.style.top=this._eCHdr.style.top=r?-o+'px':'';n.toggleClass(this._eTL,u._WJS_STICKY,r);n.toggleClass(this._eCHdr,u._WJS_STICKY,r)},u.prototype._updateScrollHandler=function(){var n=this._stickyHdr||this._clipToScreen();n!=this._scrollHandlerAttached&&(this._scrollHandlerAttached=n,n?this.addEventListener(window,'scroll',this._bndScroll,!0):this.removeEventListener(window,'scroll',this._bndScroll,!0))},u.prototype._clipToScreen=function(){var n=this.hostElement;return this.rows.length>u._MIN_VIRT_ROWS&&n.parentElement==document.body&&n.clientHeight==n.scrollHeight},u.prototype._scroll=function(t){var i=this;n.contains(t.target,this.hostElement)&&(this._clipToScreen()&&(this._afScrl&&cancelAnimationFrame(this._afScrl),this._afScrl=requestAnimationFrame(function(){i.finishEditing();i._updateContent(!0);i._afScrl=null})),this._stickyHdr&&(this._toSticky&&cancelAnimationFrame(this._toSticky),this._toSticky=requestAnimationFrame(function(){i._toSticky=null;var t=new n.CancelEventArgs;if(i.onUpdatingLayout(t)){i._updateStickyHeaders();i.onUpdatedLayout(t)}})))},u.prototype._updateScrollPosition=function(){var t=this._root,f=t.scrollTop,i=t.scrollLeft,r;return(this.rightToLeft&&u._getRtlMode()=='rev'&&(i=t.scrollWidth-t.clientWidth-i),r=new n.Point(-Math.abs(i),-f),!this._ptScrl.equals(r))?(this._ptScrl=r,this.onScrollPositionChanged(),!0):!1},u.prototype._updateContent=function(t,r){var c=n.getActiveElement(),f=n.contains(this.hostElement,c)?c:null,s=this._activeCell,l=new n.CancelEventArgs,a,u,h,e;if(this.onUpdatingView(l)){if(this._offsetY=0,this._heightBrowser>this._szClient.height&&(a=Math.round(-this._ptScrl.y/(this._heightBrowser-this._szClient.height)*100)/100,this._offsetY=Math.round(this._maxOffsetY*a)),this._updateScrollPosition(),u=this._gpCells._updateContent(t,r,this._offsetY),this._hdrVis&i.Column&&(!r||this._ssHdr&i.Column)&&this._gpCHdr._updateContent(t,r,0),this._hdrVis&i.Row&&(!r||this._ssHdr&i.Row)&&this._gpRHdr._updateContent(t,r,this._offsetY),this._hdrVis&&!r&&this._gpTL._updateContent(t,r,0),this._gpCFtr.rows.length&&(this._gpBL._updateContent(t,r,0),this._gpCFtr._updateContent(t,r,0)),this.showMarquee)if(h=this._selHdl.selection,e=this._eMarquee,this.isRangeValid(h)){var o=this._getMarqueeRect(h),v=e.firstChild,y=e.offsetWidth-v.offsetWidth,p=e.offsetHeight-v.offsetHeight;n.setCss(e,{left:o.left+this.cells.hostElement.offsetLeft-y/2,top:o.top+this.cells.hostElement.offsetTop-p/2,width:o.width+y,height:o.height+p,visibility:o.width>0&&o.height>0?'':'collapse'})}else e.style.visibility='collapse';this._useFrozenDiv()&&(this._updateFrozenCells(r),u&&u.classList.contains('wj-frozen')&&(u=null));this._activeCell=u;f&&(f!=this._root&&f!=this._eFocus&&n.contains(this.hostElement,f)&&!n.contains(this.cells.hostElement,f)?f.focus():this._setFocus(!0));!f&&u&&(u.tabIndex=0);s&&s!=u&&s.removeAttribute('tabindex');this._rcBounds=null;this.onUpdatedView(l)}},u.prototype._useFrozenDiv=function(){return n.isBoolean(this._fzClone)?this._fzClone:n.isIE()||n.isFirefox()||n.isMobile()},u.prototype._updateFrozenCells=function(t){var r,i,u;if(this.frozenRows||this.frozenColumns){if(r=this._eCt.querySelectorAll('.wj-frozen'),t&&this._fCt.children.length==r.length){for(i=0;i<r.length;i++)this._fCt.children[i].className=r[i].className;return}if(n.setText(this._fCt,null),!this.activeEditor)for(i=0;i<r.length;i++)u=r[i].cloneNode(!0),u.style.pointerEvents='auto',this._fCt.appendChild(u)}else n.setText(this._fCt,null)},u.prototype._getMarqueeRect=function(i){var s=this.getMergedRange(this.cells,i.topRow,i.leftCol)||new t.CellRange(i.topRow,i.leftCol),h=this.getMergedRange(this.cells,i.bottomRow,i.rightCol)||new t.CellRange(i.bottomRow,i.rightCol),r=this.cells.getCellBoundingRect(s.topRow,s.leftCol,!0),f=this.cells.getCellBoundingRect(h.bottomRow,h.rightCol,!0),o,e,u;return this.rows.frozen&&(o=Math.min(this.rows.length,this.rows.frozen),u=this.cells.getCellBoundingRect(o-1,0,!0),i.topRow>=o&&r.top<u.bottom&&(r.top=u.bottom),i.bottomRow>=o&&f.bottom<u.bottom&&(f.height=u.bottom-f.top)),this.columns.frozen&&(e=Math.min(this.columns.length,this.columns.frozen),u=this.cells.getCellBoundingRect(0,e-1,!0),this.rightToLeft?(i.leftCol>=e&&r.right>u.left&&(r.left=u.left-r.width),i.rightCol>=e&&f.left>u.left&&(f.left=u.left)):(i.leftCol>=e&&r.left<u.right&&(r.left=u.right),i.rightCol>=e&&f.right<u.right&&(f.width=u.right-f.left))),this.rightToLeft?new n.Rect(f.left,r.top,r.right-f.left,f.bottom-r.top):new n.Rect(r.left,r.top,f.right-r.left,f.bottom-r.top)},u.prototype._bindColumns=function(){for(var f,e,o,i,s,r=0;r<this.columns.length;r++)i=this.columns[r],i._getFlag(t.RowColFlags.AutoGenerated)&&(this.columns.removeAt(r),r--);var c=this.collectionView,u=c?c.sourceCollection:null,h=u&&u.length?u[0]:null;if(h&&this.autoGenerateColumns)for(f in h)for(e=null,o=0;o<u.length&&o<1e3&&e==null;o++)e=u[o][f],n.isPrimitive(e)&&(i=new t.Column,i._setFlag(t.RowColFlags.AutoGenerated,!0),i.binding=i.name=f,i.header=n.toHeaderCase(f),i.dataType=n.getType(e),i.dataType==n.DataType.Number&&(i.width=80),s=Object.getOwnPropertyDescriptor(h,f),!s||s.writable||n.isFunction(s.set)||i._setFlag(t.RowColFlags.ReadOnly,!0),this.columns.push(i));this._updateColumnTypes()},u.prototype._updateColumnTypes=function(){var u=this.collectionView,f,r,i,t;if(n.hasItems(u))for(f=u.items[0],r=this.columns,i=0;i<r.length;i++)t=r[i],t.dataType==null&&t._binding&&(t.dataType=n.getType(t._binding.getValue(f)))},u.prototype._getBindingColumn=function(n,t,i){return i},u.prototype._getRowHeaderPath=function(){return this._rowHdrPath},u.prototype._bindRows=function(){var f=new n.CancelEventArgs,i,r,u,t;if(this.onLoadingRows(f)){if(this.rows.clear(),i=this.collectionView,i&&i.items)if(r=i.items,u=i.groups,this.childItemsPath)for(t=0;t<r.length;t++)this._addNode(r,t,0);else if(u!=null&&u.length>0&&this.showGroups)for(t=0;t<u.length;t++)this._addGroup(u[t]);else for(t=0;t<r.length;t++)this._addBoundRow(r,t);this.onLoadedRows(f)}},u.prototype._addBoundRow=function(n,i){this.rows.push(new t.Row(n[i]))},u.prototype._addNode=function(i,r,u){var e=new t.GroupRow,o=this.childItemsPath,c=n.isArray(o)?o[u]:o,h=i[r],s=h[c],f;if(e.dataItem=h,e.level=u,this.rows.push(e),n.isArray(s))for(f=0;f<s.length;f++)this._addNode(s,f,u+1)},u.prototype._addGroup=function(n){var r=new t.GroupRow,u,i;if(r.level=n.level,r.dataItem=n,this.rows.push(r),n.isBottomLevel)for(u=n.items,i=0;i<u.length;i++)this._addBoundRow(u,i);else for(i=0;i<n.groups.length;i++)this._addGroup(n.groups[i])},u._getSerializableProperties=function(n){var f=[],u,i,t,r;for(n=n.prototype;n!=Object.prototype;n=Object.getPrototypeOf(n))for(u=Object.getOwnPropertyNames(n),i=0;i<u.length;i++)t=u[i],r=Object.getOwnPropertyDescriptor(n,t),r&&r.set&&r.get&&t[0]!='_'&&!t.match(/disabled|required/)&&f.push(t);return f},u.prototype._copy=function(i,r){var f,u,e;if(i=='columns'){for(this.columns.clear(),f=n.asArray(r),u=0;u<f.length;u++)e=new t.Column,n.copy(e,f[u]),this.columns.push(e);return!0}return!1},u.prototype._isInputElement=function(n){if(n instanceof HTMLElement){if(n.contentEditable=='true')return!0;var t=n.tagName.match(/^(BUTTON|A|INPUT|TEXTAREA|SELECT|OPTION)$/i);return t&&t.length>0}return!1},u.prototype._wantsInput=function(n){return!this.activeEditor&&this._isInputElement(n)},u._getMaxSupportedCssHeight=function(){var n;if(!u._maxCssHeight){var i=1e6,t=document.createElement('div');for(t.style.visibility='hidden',document.body.appendChild(t),n=i;n<=6e7;n+=5e5){if(t.style.height=n+'px',t.offsetHeight!=n)break;i=n}document.body.removeChild(t);u._maxCssHeight=i}return u._maxCssHeight},u._getRtlMode=function(){var t,i,r;return u._rtlMode||(t=n.createElement('<div dir="rtl" style="visibility:hidden;width:100px;height:100px;overflow:auto"><div style="width:2000px;height:2000px"><\/div><\/div>'),document.body.appendChild(t),i=t.scrollLeft,t.scrollLeft=-1e3,r=t.scrollLeft,document.body.removeChild(t),u._rtlMode=r<0?'neg':i>0?'rev':'std'),u._rtlMode},u}(n.Control);r._WJS_STICKY='wj-state-sticky';r._WJS_MEASURE='wj-state-measuring';r._WJS_UPDATING='wj-state-updating';r._MIN_VIRT_ROWS=200;r.controlTemplate='<div style="position:relative;width:100%;height:100%;overflow:hidden;max-width:inherit;max-height:inherit"><div wj-part="focus" aria-hidden="true" style="position:fixed;opacity:0;pointer-events:none;left:-10px;top:-10px"><\/div><div wj-part="root" style="position:absolute;width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch;max-width:inherit;max-height:inherit"><div wj-part="cells" class="wj-cells" style="position:absolute"><\/div><div wj-part="marquee" aria-hidden="true" class="wj-marquee" style="display:none;pointer-events:none;"><div style="width:100%;height:100%"><\/div><\/div><\/div><div wj-part="fcells" aria-hidden="true" class="wj-cells" style="position:absolute;pointer-events:none;overflow:hidden"><\/div><div wj-part="rh" aria-hidden="true" style="position:absolute;overflow:hidden;outline:none"><div wj-part="rhcells" class="wj-rowheaders" style="position:relative"><\/div><\/div><div wj-part="cf" aria-hidden="true" style="position:absolute;overflow:hidden;outline:none"><div wj-part="cfcells" class="wj-colfooters" style="position:relative"><\/div><\/div><div wj-part="ch" aria-hidden="true" style="position:absolute;overflow:hidden;outline:none"><div wj-part="chcells" class="wj-colheaders" style="position:relative"><\/div><\/div><div wj-part="bl" aria-hidden="true" style="position:absolute;overflow:hidden;outline:none"><div wj-part="blcells" class="wj-bottomleft" style="position:relative"><\/div><\/div><div wj-part="tl" aria-hidden="true" style="position:absolute;overflow:hidden;outline:none"><div wj-part="tlcells" class="wj-topleft" style="position:relative"><\/div><\/div><div wj-part="sz" aria-hidden="true" style="position:relative;visibility:hidden"><\/div><\/div>';t.FlexGrid=r})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){'use strict';var i=function(i){function r(r,u,f){var e=i.call(this)||this;return e._p=n.asType(r,t.GridPanel),e._rng=n.asType(u,t.CellRange),e._data=f,e}return __extends(r,i),Object.defineProperty(r.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"range",{get:function(){return this._rng.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"row",{get:function(){return this._rng.row},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"col",{get:function(){return this._rng.col},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"data",{get:function(){return this._data},set:function(n){this._data=n},enumerable:!0,configurable:!0}),r}(n.CancelEventArgs),r,u;t.CellRangeEventArgs=i;r=function(t){function i(i,r,u){var f=t.call(this,i,r)||this;return f._cell=n.asType(u,HTMLElement),f}return __extends(i,t),Object.defineProperty(i.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),i}(i);t.FormatItemEventArgs=r;u=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),Object.defineProperty(i.prototype,"stayInEditMode",{get:function(){return this._stayInEditMode},set:function(t){this._stayInEditMode=n.asBoolean(t)},enumerable:!0,configurable:!0}),i}(i);t.CellEditEndingEventArgs=u})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){'use strict';var i,r;(function(n){n[n.None=0]="None";n[n.Cell=1]="Cell";n[n.ColumnHeader=2]="ColumnHeader";n[n.RowHeader=3]="RowHeader";n[n.TopLeft=4]="TopLeft";n[n.ColumnFooter=5]="ColumnFooter";n[n.BottomLeft=6]="BottomLeft"})(i=t.CellType||(t.CellType={}));r=function(){function r(i,u,f,e,o){this._offsetY=0;this._g=n.asType(i,t.FlexGrid);this._ct=n.asInt(u);this._rows=n.asType(f,t.RowCollection);this._cols=n.asType(e,t.ColumnCollection);this._e=n.asType(o,HTMLElement);this._vrb=new t.CellRange;r._evtBlur||(r._evtBlur=document.createEvent('HTMLEvents'),r._evtBlur.initEvent('blur',!0,!1))}return Object.defineProperty(r.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cellType",{get:function(){return this._ct},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"viewRange",{get:function(){return this._getViewRange()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this._cols.getTotalSize()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._rows.getTotalSize()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),r.prototype.getCellData=function(r,u,f){var s=this._rows[n.asNumber(r,!1,!0)],h,o=null,e,c,l,a;if(n.isString(u)&&(u=this._cols.indexOf(u),u<0))throw'Invalid column name or binding.';if(h=this._cols[n.asNumber(u,!1,!0)],e=this._g?this._g._getBindingColumn(this,r,h):h,!e.binding||!s.dataItem||s.dataItem instanceof n.collections.CollectionViewGroup?s._ubv&&(o=s._ubv[h._hash]):o=e._binding.getValue(s.dataItem),o==null)switch(this._ct){case i.ColumnHeader:(r==this._rows.length-1||e!=h)&&(o=e.header);break;case i.ColumnFooter:e.aggregate!=n.Aggregate.None&&s instanceof t.GroupRow&&(c=this._g.collectionView,c&&(l=n.tryCast(c,n.collections.CollectionView),o=l?l.getAggregate(e.aggregate,e.binding):n.getAggregate(e.aggregate,c.items,e.binding)));break;case i.Cell:e.aggregate!=n.Aggregate.None&&s instanceof t.GroupRow&&(a=n.tryCast(s.dataItem,n.collections.CollectionViewGroup),a&&(o=a.getAggregate(e.aggregate,e.binding,this._g.collectionView)))}return f&&(this.cellType==i.Cell&&e.dataMap&&(o=e.dataMap.getDisplayValue(o)),o=o!=null?n.Globalize.format(o,e.format):''),o},r.prototype.setCellData=function(t,r,u,f,e){var s,v,o,c,y,h,p,a,k;if(f===void 0&&(f=!0),e===void 0&&(e=!0),s=this._rows[n.asNumber(t,!1,!0)],n.isString(r)&&(r=this._cols.indexOf(r),r<0))throw'Invalid column name or binding.';if(v=this._cols[n.asNumber(r,!1,!0)],o=this._g?this._g._getBindingColumn(this,t,v):v,this._ct==i.Cell){if(o.dataMap&&u!=null&&(o.isRequired||u!==''&&u!=null))if(c=o.dataMap,y=c.getKeyValue(u),y==null){if(!c.isEditable||c.displayMemberPath!=c.selectedValuePath)return!1}else u=y;if(h=n.DataType.Object,o.dataType?h=o.dataType:(p=this.getCellData(t,r,!1),h=n.getType(p)),n.isBoolean(o.isRequired))if(o.isRequired||u!==''&&u!==null){if(o.isRequired&&(u===''||u===null))return!1}else u=null,f=!1;if(f&&(u=n.changeType(u,h,o.format),h!=n.DataType.Object&&n.getType(u)!=h))return!1}if(s.dataItem&&o.binding){var w=o._binding,l=s.dataItem,b=w.getValue(l);if(u!==b&&!n.DateTime.equals(u,b)&&(w.setValue(l,u),a=this._g.collectionView,a instanceof n.collections.CollectionView&&l!=a.currentEditItem)){k=new n.collections.NotifyCollectionChangedEventArgs(n.collections.NotifyCollectionChangedAction.Change,l,a.items.indexOf(l));a.onCollectionChanged(k)}}else s._ubv||(s._ubv={}),s._ubv[v._hash]=u;return e&&this._g&&this._g.invalidate(),!0},r.prototype.getCellBoundingRect=function(t,i,r){var o=this.rows[t],s=this.columns[i],u=new n.Rect(s.pos,o.pos,s.renderSize,o.renderSize),f,e;return this._g.rightToLeft&&(u.left=this.hostElement.clientWidth-u.right,n.isIE()||n.isFirefox()||(f=this.hostElement.parentElement,u.left-=f.offsetWidth-f.clientWidth)),r||(e=this.hostElement.getBoundingClientRect(),u.left+=e.left,u.top+=e.top-this._offsetY),t<this.rows.frozen&&(u.top-=this._g.scrollPosition.y),i<this.columns.frozen&&(u.left-=this._g.scrollPosition.x*(this._g.rightToLeft?-1:1)),u},r.prototype.getCellElement=function(n,t){for(var e,h,u,o,i,s=this.hostElement.children,c=Math.min(n+2,s.length),f=0;f<c;f++)for(e=s[f].children,h=Math.min(t+1,e.length),u=0;u<h;u++)if(o=e[u],i=o[r._INDEX_KEY],i&&(i.row==n&&i.col==t||i.rng&&i.rng.contains(n,t)))return o;return null},r.prototype.getSelectedState=function(n,r,u){var e=this._g,o=e.selectionMode,f=e._selHdl.selection;if(o!=t.SelectionMode.None)switch(this._ct){case i.Cell:if(u||(u=e.getMergedRange(this,n,r)),u){if(u.contains(f.row,f.col))return e.showMarquee?t.SelectedState.None:t.SelectedState.Cursor;if(u.intersects(f))return t.SelectedState.Selected}return f.row==n&&f.col==r?e.showMarquee?t.SelectedState.None:t.SelectedState.Cursor:e.rows[n].isSelected||e.columns[r].isSelected?t.SelectedState.Selected:(f=e._selHdl._adjustSelection(f),o==t.SelectionMode.ListBox)?t.SelectedState.None:f.containsRow(n)&&f.containsColumn(r)?t.SelectedState.Selected:t.SelectedState.None;case i.ColumnHeader:if(e.showSelectedHeaders&t.HeadersVisibility.Column&&(e.columns[r].isSelected||f.containsColumn(r)||f.intersectsColumn(u))&&(u&&(n=u.bottomRow),n==this.rows.length-1))return t.SelectedState.Selected;break;case i.RowHeader:if(e.showSelectedHeaders&t.HeadersVisibility.Row&&(e.rows[n].isSelected||f.containsRow(n)||f.intersectsRow(u))&&(u&&(r=u.rightCol),r==this.columns.length-1))return t.SelectedState.Selected}return t.SelectedState.None},Object.defineProperty(r.prototype,"hostElement",{get:function(){return this._e},enumerable:!0,configurable:!0}),r.prototype._getOffsetY=function(){return this._offsetY},r.prototype._updateContent=function(u,f,e){var v=this._g,h=this._e,l=this._rows,y=this._cols,p=this._ct,w,b,c,o,g,k,nt,d,a,s;if((p==i.ColumnHeader||p==i.ColumnFooter||p==i.RowHeader)&&(w=v._ptScrl,b=h.style,p==i.RowHeader?b.top=w.y+'px':v.rightToLeft?b.right=w.x+'px':b.left=w.x+'px'),this._offsetY!=e&&(u=!1,this._offsetY=e),c=this._getViewRange(),l.length<=v._virtualizationThreshold?o=new t.CellRange(0,0,l.length-1,y.length-1):(o=c.clone(),o.isValid&&v.isTouching&&(g=6,o.row=Math.max(c.row-g,l.frozen),o.row2=Math.min(c.row2+g,l.length-1),o.col=Math.max(c.col-1,y.frozen),o.col2=Math.min(c.col2+1,y.length-1))),u&&!f&&this._vrb.contains(c)&&!l.frozen&&!y.frozen)return this._activeCell;if(u&&o.equals(this._vrb)||(f=!1),!u){var tt=n.getActiveElement(),it=n.contains(h,tt)?tt:null,rt=v.cellFactory;for(k=0;k<h.childElementCount;k++)for(nt=h.children[k],d=0;d<nt.childElementCount;d++)rt.disposeCell(nt.children[d]);n.setText(h,null);it&&it.dispatchEvent(r._evtBlur)}for(u&&!f&&this._ct!=i.TopLeft&&this._reorderCells(o,this._vrb),this._activeCell=null,this._vru=c,this._vrb=o,a=0,this._ct==i.Cell&&(a=this._renderColHdrRow(o,f)),s=0;s<l.frozen&&s<l.length;s++)a=this._renderRow(s,o,f,a);for(s=o.topRow;s<=o.bottomRow&&s>-1;s++)a=this._renderRow(s,o,f,a);while(h.childElementCount>a)h.removeChild(h.lastChild);return this._activeCell},r.prototype._reorderCells=function(n,t){var u,e,c;if(!(this._rows.frozen>0)&&!(this._cols.frozen>0)&&n.columnSpan==t.columnSpan&&n.rowSpan==t.rowSpan&&t.isValid&&n.isValid&&n.intersects(t)&&n.row!=t.row){var r=n.row-t.row,l=Math.max(1,n.rowSpan-1),f=this._e;if(r!=0&&Math.abs(r)<l){if(u=this._ct==i.Cell?1:0,e=f.childElementCount,r>0){var h=u,o=Math.min(u+r,e-1),s=this._createRange(h,o);s&&o<e-1&&f.appendChild(s.extractContents())}if(r<0){var o=e,h=Math.max(u,o+r),s=this._createRange(h,o);s&&h>u&&(c=f.children[u],f.insertBefore(s.extractContents(),c))}}}},r.prototype._createRange=function(n,t){var i,r=this._e.childElementCount;return t>n&&t<=r&&n>-1&&(i=document.createRange(),i.setStart(this._e,n),i.setEnd(this._e,t)),i},r.prototype._renderColHdrRow=function(t,i){var f=this._e.children[0],u,e,r;for(f||(f=n.createElement('<div class="wj-row" role="row" tabindex="-1"></div>',this._e)),u=0,e=this._g._getRowHeaderPath(),e&&(u=this._renderRowHdrCell(f,-1,e.path)),r=0;r<this.columns.frozen&&r<this.columns.length;r++)u=this._renderColHdrCell(f,r,t,i,u);for(r=t.leftCol;r<=t.rightCol&&r>-1;r++)u=this._renderColHdrCell(f,r,t,i,u);return 1},r.prototype._renderColHdrCell=function(t,i,u,f,e){var s=this.columns[i],o,c,h,l;if(s.renderSize<=0)return e;if(o=t.children[e],o||(o=n.createElement('<div class="wj-cell" role="columnheader" tabindex="-1"></div>',t)),f||(o.textContent=this.columns[i].header,n.setCss(o,{left:s.pos,width:s.renderSize,top:-32e3,height:.1,overflow:'hidden'})),c=this.grid,c.allowSorting){h='none';l=c._getBindingColumn(this,0,s);switch(l.currentSort){case'+':h='ascending';break;case'-':h='descending'}n.setAttribute(o,'aria-sort',h)}return o[r._INDEX_KEY]={row:-1,col:i,panel:this},e+1},r.prototype._renderRowHdrCell=function(t,i,u){var f=t.children[0];return f||(f=n.createElement('<div class="wj-cell" tabindex="-1"></div>',t)),n.setAttribute(f,'role',i<0?'columnheader':'rowheader'),n.setText(f,u?u.toString():''),n.setCss(f,{left:-32e3,top:-32e3,width:.1,height:.1,overflow:'hidden'}),f[r._INDEX_KEY]={row:i,col:-1,panel:this},1},r.prototype._renderRow=function(t,r,u,f){var c=this.rows[t],l=c.renderSize,e,s,h,o;if(l<=0)return f;for(e=this._e.children[f],e||(e=n.createElement('<div class="wj-row" tabindex="-1"></div>',this._e),this._ct==i.Cell&&e.setAttribute('role','row')),s=0,this._ct==i.Cell&&(h=this._g._getRowHeaderPath(),h&&(s=this._renderRowHdrCell(e,t,h.getValue(c.dataItem)))),o=0;o<this.columns.frozen&&o<this.columns.length;o++)s=this._renderCell(e,t,o,r,u,s);for(o=r.leftCol;o<=r.rightCol&&o>-1;o++)s=this._renderCell(e,t,o,r,u,s);while(e.childElementCount>s)e.removeChild(e.lastElementChild);return f+1},r.prototype._renderCell=function(u,f,e,o,s,h){var p=this._g,l=p.getMergedRange(this,f,e),a,w,y,v;if(l){for(a=Math.max(o.row,l.row);a<f;a++)if(this.rows[a].isVisible)return h;for(a=Math.max(o.col,l.col);a<e;a++)if(this.columns[a].isVisible)return h}if(w=this.columns[e],w.renderSize<=0&&(!l||l.getRenderSize(this).width<=0))return h;y=!1;this.cellType==i.Cell&&(v=p._selHdl.selection,y=v.row==f&&v.col==e||l&&l.contains(v.row,v.col));var c=u.children[h],b=this.getSelectedState(f,e,l),k=t.SelectedState;return c&&s?(n.toggleClass(c,'wj-state-selected',b==k.Cursor),n.toggleClass(c,'wj-state-multi-selected',b==k.Selected),y&&(this._activeCell=c),h+1):(c||(c=document.createElement('div'),c.tabIndex=-1,this._ct==i.Cell&&c.setAttribute('role','gridcell'),u.appendChild(c)),y&&(this._activeCell=c),p.cellFactory.updateCell(this,f,e,c,l),c[r._INDEX_KEY]={row:f,col:e,rng:l,panel:this},h+1)},r.prototype._getViewRange=function(){var e=this._g,l=e._ptScrl,r=this._rows,u=this._cols,n=new t.CellRange(0,0,r.length-1,u.length-1),o,f;if(this._ct==i.Cell||this._ct==i.RowHeader){var h=-l.y+this._offsetY,a=e._szClient.height,s=Math.min(r.frozen,r.length-1);s>0&&(f=r[s-1].pos,h+=f,a-=f);n.row=Math.min(r.length-1,Math.max(r.frozen,r.getItemAt(h+1)));n.row2=r.getItemAt(h+a);e._clipToScreen()&&(o=e.hostElement.getBoundingClientRect(),o.top<0&&(n.row=Math.max(n.row,r.getItemAt(-o.top)-1)),o.bottom>innerHeight&&(n.row2=Math.min(n.row2,r.getItemAt(-o.top+innerHeight)+1)))}if(this._ct==i.Cell||this._ct==i.ColumnHeader){var c=-l.x,v=e._szClient.width,s=Math.min(u.frozen,u.length-1);s>0&&(f=u[s-1].pos,c+=f,v-=f);n.col=Math.min(u.length-1,Math.max(u.frozen,u.getItemAt(c+1)));n.col2=u.getItemAt(c+v)}return r.length<=r.frozen&&(n.row=n.row2=-1),u.length<=u.frozen&&(n.col=n.col2=-1),n},r.prototype._getFrozenPos=function(){var r=this._rows.frozen,u=this._cols.frozen,t=r>0?this._rows[r-1]:null,i=u>0?this._cols[u-1]:null,f=t?t.pos+t.renderSize:0,e=i?i.pos+i.renderSize:0;return new n.Point(e,f)},r}();r._INDEX_KEY='wj-cell-index';t.GridPanel=r})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){'use strict';var i=function(){function i(){}return i.prototype.updateCell=function(r,u,f,e,o,s){var h=r.grid,ot=h.rightToLeft,y=r.cellType,p=r.rows,w=r.columns,v=p[u],nt=w[f],rt=u,st=f,b=v instanceof t.GroupRow?v:null,gt=v instanceof t._NewRowTemplate?v:null,ni=nt.renderWidth,ti=v.renderHeight,a='wj-cell',at=s!=!1,l={display:''},vt,pt,ct,g,ii,wt,lt,k,bt,kt,d,dt,tt,ri,ut,ui,it,fi,ft,et,ei;s!=!1&&e.firstElementChild&&(e.childNodes.length!=1||e.firstElementChild.type!='checkbox')&&(n.setText(e,null),at=!1);o&&!o.isSingleCell&&(u=o.row,f=o.col,rt=o.row2,st=o.col2,v=p[u],nt=w[f],b=n.tryCast(v,t.GroupRow),vt=o.getRenderSize(r),ti=vt.height,ni=vt.width);var c=h._getBindingColumn(r,u,nt),oi=c.dataType==n.DataType.Boolean&&!c.dataMap,ht=nt.pos,yt=v.pos;h._useFrozenDiv()&&y==t.CellType.Cell&&!h.editRange?(u<p.frozen&&f>=w.frozen&&(ht+=h._ptScrl.x),f<w.frozen&&u>=p.frozen&&(yt+=h._ptScrl.y)):(u<p.frozen&&(yt-=h._ptScrl.y),f<w.frozen&&(ht-=h._ptScrl.x));(u<p.frozen||f<w.frozen)&&(at=!1);ot?l.right=ht+'px':l.left=ht+'px';l.top=yt-r._getOffsetY()+'px';l.width=ni+'px';l.height=ti+'px';l.zIndex='';(u<p.frozen||f<w.frozen)&&(l.zIndex=u<p.frozen&&f<w.frozen?2:1);y==t.CellType.Cell?(b&&(a+=' wj-group'),h.showAlternatingRows&&v.visibleIndex%2!=0&&(o&&o.row!=o.row2||(a+=' wj-alt')),(u<p.frozen||f<w.frozen)&&(a+=' wj-frozen'),gt&&(a+=' wj-new'),v.cssClass&&(a+=' '+v.cssClass),c.cssClass&&(a+=' '+c.cssClass)):(a+=' wj-header',h.showAlternatingRows&&u%2!=0&&(a+=' wj-header-alt'));(y==t.CellType.Cell||y==t.CellType.RowHeader)&&h._getShowErrors()&&(pt=h._getError(r,u,f),pt?(a+=' wj-state-invalid',e.title=pt):e.title='');ct=r.getSelectedState(u,f,o);ct!=t.SelectedState.None&&y==t.CellType.Cell&&!oi&&h.editRange&&h.editRange.contains(u,f)&&(ct=t.SelectedState.None);switch(ct){case t.SelectedState.Cursor:a+=' wj-state-selected';break;case t.SelectedState.Selected:a+=' wj-state-multi-selected'}if(rt==p.frozen-1&&(a+=' wj-frozen-row'),st==w.frozen-1&&(a+=' wj-frozen-col'),(c.wordWrap||v.wordWrap)&&(a+=' wj-wrap'),at&&a==e.className&&(g=e.style,g.top==l.top&&g.width==l.width&&g.height==l.height&&(ot&&g.right==l.right||!ot&&g.left==l.left))){g.display&&(g.display='');return}l.textAlign=c.getAlignment();l.paddingLeft=l.paddingRight=l.paddingTop=l.paddingBottom='';y==t.CellType.Cell&&h.rows.maxGroupLevel>-1&&f==h.columns.firstVisibleIndex&&h.treeIndent&&(ii=b?Math.max(0,b.level):h.rows.maxGroupLevel+1,wt=h.treeIndent*ii+h._cellPadding,ot?l.paddingRight=wt+'px':l.paddingLeft=wt+'px');s!=!1&&(lt=r.getCellData(u,f,!1),k=r.getCellData(u,f,!0),y==t.CellType.Cell&&f==h.columns.firstVisibleIndex&&b&&b.hasChildren&&!this._isEditingCell(h,u,f)?(k||(k=b.getGroupHeader()),e.innerHTML=this._getTreeIcon(b)+' '+k,l.textAlign=''):y==t.CellType.ColumnHeader&&c.currentSort&&h.showSort&&(rt==h._getSortRowIndex()||c!=nt)?(a+=' wj-sort-'+(c.currentSort=='+'?'asc':'desc'),e.innerHTML=n.escapeHtml(k)+'&nbsp;'+this._getSortIcon(c)):y!=t.CellType.RowHeader||f!=h.rowHeaders.columns.length-1||k?y!=t.CellType.Cell||c.dataType!=n.DataType.Boolean||c.dataMap||b&&!n.isBoolean(lt)?y==t.CellType.Cell&&this._isEditingCell(h,u,f)?(dt=c.inputType,c.inputType||(dt=c.dataType==n.DataType.Number&&!c.dataMap?'tel':'text'),c.dataMap||c.mask||(tt=r.getCellData(u,f,!1),n.isNumber(tt)&&(ri=tt.toString(),ut=c.format,ut&&tt!=Math.round(tt)&&(ui=ri.match(/\.(\d+)/)[1].length,ut=ut.replace(/([a-z])(\d*)(.*)/ig,'$01'+ui+'$3')),k=n.Globalize.formatNumber(tt,ut,!0))),e.innerHTML='<input type="'+dt+'" class="wj-grid-editor wj-form-control">',it=e.children[0],it.value=k,it.required=c.getIsRequired(),it.style.textAlign=c.getAlignment(),l.paddingTop=l.paddingBottom='0px',c.mask&&new n._MaskProvider(it,c.mask),h._edtHdl._edt=it):y==t.CellType.Cell&&(v.isContentHtml||c.isContentHtml)?e.innerHTML=k:n.setText(e,k):(d=e.firstChild,d instanceof HTMLInputElement&&d.type=='checkbox'||(e.innerHTML='<input type="checkbox" class="wj-cell-check" tabindex="-1"/>',d=e.firstChild),d.checked=lt==!0?!0:!1,d.indeterminate=lt==null,d.disabled=!h.canEditCell(u,f),d.disabled&&(d.style.cursor='default'),h.editRange&&h.editRange.contains(u,f)&&(h._edtHdl._edt=d)):(bt=h.editableCollectionView,kt=bt?bt.currentEditItem:null,kt&&v.dataItem==kt?e.innerHTML='<span class="wj-glyph-pencil"></span>':n.tryCast(v,t._NewRowTemplate)&&(e.innerHTML='<span class="wj-glyph-asterisk"></span>')),y==t.CellType.Cell&&n.input&&c.dataMap&&c.showDropDown!=!1&&h.canEditCell(u,f)&&(i._ddIcon||(i._ddIcon=n.createElement('<div role="button" class="'+i._WJC_DROPDOWN+'"><span class="wj-glyph-down"><\/span><\/div>')),fi=i._ddIcon.cloneNode(!0),e.appendChild(fi)));ft=!1;switch(y){case t.CellType.RowHeader:ft=!b&&!gt&&v.allowDragging&&(h.allowDragging&t.AllowDragging.Rows)!=0;n.setAttribute(e,'draggable',ft?'true':null);break;case t.CellType.ColumnHeader:ft=nt.allowDragging&&(h.allowDragging&t.AllowDragging.Columns)!=0;n.setAttribute(e,'draggable',ft?'true':null)}if(e.className!=a&&(e.className=a),n.setCss(e,l),h.itemFormatter&&h.itemFormatter(r,u,f,e),h.formatItem.hasHandlers){et=i._fmtRng;et?et.setRange(u,f,rt,st):et=i._fmtRng=new t.CellRange(u,f,rt,st);ei=new t.FormatItemEventArgs(r,et,e);h.onFormatItem(ei)}},i.prototype.disposeCell=function(){},i.prototype.getEditorValue=function(n){var t=n._edtHdl._edt;return t instanceof HTMLInputElement?t.type=='checkbox'?t.checked:t.value:null},i.prototype._isEditingCell=function(n,t,i){return n.editRange&&n.editRange.contains(t,i)},i.prototype._getTreeIcon=function(n){var t='wj-glyph-'+(n.isCollapsed?'':'down-')+(n.grid.rightToLeft?'left':'right');return'<span role="button" class="'+i._WJC_COLLAPSE+' '+t+'"></span>'},i.prototype._getSortIcon=function(n){return'<span class="wj-glyph-'+(n.currentSort=='+'?'up':'down')+'"></span>'},i}();i._WJC_COLLAPSE='wj-elem-collapse';i._WJC_DROPDOWN='wj-elem-dropdown';t.CellFactory=i})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){'use strict';var i=function(){function t(n,t,i,r){n===void 0&&(n=-1);t===void 0&&(t=-1);i===void 0&&(i=n);r===void 0&&(r=t);this.setRange(n,t,i,r)}return t.prototype.setRange=function(t,i,r,u){t===void 0&&(t=-1);i===void 0&&(i=-1);r===void 0&&(r=t);u===void 0&&(u=i);this._row=n.asInt(t);this._col=n.asInt(i);this._row2=n.asInt(r);this._col2=n.asInt(u)},Object.defineProperty(t.prototype,"row",{get:function(){return this._row},set:function(t){this._row=n.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col",{get:function(){return this._col},set:function(t){this._col=n.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"row2",{get:function(){return this._row2},set:function(t){this._row2=n.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col2",{get:function(){return this._col2},set:function(t){this._col2=n.asInt(t)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this._row,this._col,this._row2,this._col2)},Object.defineProperty(t.prototype,"rowSpan",{get:function(){return Math.abs(this._row2-this._row)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnSpan",{get:function(){return Math.abs(this._col2-this._col)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRow",{get:function(){return Math.min(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRow",{get:function(){return Math.max(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftCol",{get:function(){return Math.min(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightCol",{get:function(){return Math.max(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValid",{get:function(){return this._row>-1&&this._col>-1&&this._row2>-1&&this._col2>-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSingleCell",{get:function(){return this._row==this._row2&&this._col==this._col2},enumerable:!0,configurable:!0}),t.prototype.contains=function(i,r){var u=n.tryCast(i,t);if(u)return u.topRow>=this.topRow&&u.bottomRow<=this.bottomRow&&u.leftCol>=this.leftCol&&u.rightCol<=this.rightCol;if(n.isInt(i)&&n.isInt(r))return i>=this.topRow&&i<=this.bottomRow&&r>=this.leftCol&&r<=this.rightCol;throw'contains expects a CellRange or row/column indices.';},t.prototype.containsRow=function(t){return n.asInt(t)>=this.topRow&&t<=this.bottomRow},t.prototype.containsColumn=function(t){return n.asInt(t)>=this.leftCol&&t<=this.rightCol},t.prototype.intersects=function(n){return this.intersectsRow(n)&&this.intersectsColumn(n)},t.prototype.intersectsRow=function(n){return n&&!(this.bottomRow<n.topRow||this.topRow>n.bottomRow)},t.prototype.intersectsColumn=function(n){return n&&!(this.rightCol<n.leftCol||this.leftCol>n.rightCol)},t.prototype.getRenderSize=function(t){var u=new n.Size(0,0),i,r;if(this.isValid){for(i=this.topRow;i<=this.bottomRow;i++)u.height+=t.rows[i].renderSize;for(r=this.leftCol;r<=this.rightCol;r++)u.width+=t.columns[r].renderSize}return u},t.prototype.equals=function(n){return n instanceof t&&this._row==n._row&&this._col==n._col&&this._row2==n._row2&&this._col2==n._col2},t}();t.CellRange=i})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){'use strict';var i,u,r,e,o,f,s,h;(function(n){n[n.Visible=1]="Visible";n[n.AllowResizing=2]="AllowResizing";n[n.AllowDragging=4]="AllowDragging";n[n.AllowMerging=8]="AllowMerging";n[n.AllowSorting=16]="AllowSorting";n[n.AutoGenerated=32]="AutoGenerated";n[n.Collapsed=64]="Collapsed";n[n.ParentCollapsed=128]="ParentCollapsed";n[n.Selected=256]="Selected";n[n.ReadOnly=512]="ReadOnly";n[n.HtmlContent=1024]="HtmlContent";n[n.WordWrap=2048]="WordWrap";n[n.RowDefault=3]="RowDefault";n[n.ColumnDefault=23]="ColumnDefault"})(i=t.RowColFlags||(t.RowColFlags={}));u=function(){function r(){this._list=null;this._pos=0;this._idx=-1;this._vidx=-1}return Object.defineProperty(r.prototype,"visible",{get:function(){return this._getFlag(i.Visible)},set:function(n){this._setFlag(i.Visible,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isVisible",{get:function(){return this._getFlag(i.Visible)?this._getFlag(i.ParentCollapsed)&&!(this instanceof t._NewRowTemplate)?!1:!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pos",{get:function(){return this._list&&this._list._update(),this._pos},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"index",{get:function(){return this._list&&this._list._update(),this._idx},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visibleIndex",{get:function(){return this._list&&this._list._update(),this.isVisible?this._vidx:-1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"size",{get:function(){return this._sz},set:function(t){t!=this._sz&&(this._sz=n.asNumber(t,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderSize",{get:function(){if(!this.isVisible)return 0;var n=this._sz,t=this._list;return t&&((n==null||n<0)&&(n=Math.round(t.defaultSize)),t.minSize!=null&&n<t.minSize&&(n=t.minSize),t.maxSize!=null&&n>t.maxSize&&(n=t.maxSize)),this._szMin!=null&&n<this._szMin&&(n=this._szMin),this._szMax!=null&&n>this._szMax&&(n=this._szMax),Math.round(n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"allowResizing",{get:function(){return this._getFlag(i.AllowResizing)},set:function(n){this._setFlag(i.AllowResizing,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"allowDragging",{get:function(){return this._getFlag(i.AllowDragging)},set:function(n){this._setFlag(i.AllowDragging,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"allowMerging",{get:function(){return this._getFlag(i.AllowMerging)},set:function(n){this._setFlag(i.AllowMerging,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isSelected",{get:function(){return this._getFlag(i.Selected)},set:function(n){if(this._setFlag(i.Selected,n,!0)){var t=this.grid;t&&t.refreshCells(!1,!0,!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isReadOnly",{get:function(){return this._getFlag(i.ReadOnly)},set:function(n){this._setFlag(i.ReadOnly,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isContentHtml",{get:function(){return this._getFlag(i.HtmlContent)},set:function(n){this.isContentHtml!=n&&(this._setFlag(i.HtmlContent,n),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"wordWrap",{get:function(){return this._getFlag(i.WordWrap)},set:function(n){this._setFlag(i.WordWrap,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cssClass",{get:function(){return this._cssClass},set:function(t){t!=this._cssClass&&(this._cssClass=n.asString(t),this.grid&&this.grid.invalidate(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"grid",{get:function(){return this._list?this._list._g:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"collectionView",{get:function(){return this.grid?this.grid.collectionView:null},enumerable:!0,configurable:!0}),r.prototype.onPropertyChanged=function(){this._list&&(this._list._dirty=!0,this.grid.invalidate())},r.prototype._getFlag=function(n){return(this._f&n)!=0},r.prototype._setFlag=function(n,t,i){return t!=this._getFlag(n)?(this._f=t?this._f|n:this._f&~n,i||this.onPropertyChanged(),!0):!1},r}();t.RowCol=u;r=function(r){function u(t){var f=r.call(this)||this;return f._f=i.ColumnDefault,f._hash=u._ctr.toString(36),u._ctr++,t&&n.copy(f,t),f}return __extends(u,r),Object.defineProperty(u.prototype,"name",{get:function(){return this._name},set:function(n){this._name=n},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"dataType",{get:function(){return this._type},set:function(t){this._type!=t&&(this._type=n.asEnum(t,n.DataType),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isRequired",{get:function(){return this._required},set:function(t){this._required=n.asBoolean(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showDropDown",{get:function(){return this._showDropDown},set:function(t){t!=this._showDropDown&&(this._showDropDown=n.asBoolean(t,!0),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"dropDownCssClass",{get:function(){return this._ddCssClass},set:function(t){this._ddCssClass=n.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"inputType",{get:function(){return this._inpType},set:function(t){this._inpType=n.asString(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask=n.asString(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"binding",{get:function(){return this._binding?this._binding.path:null},set:function(t){var r,i,u;t!=this.binding&&(r=n.asString(t),this._binding=r?new n.Binding(r):null,!this._type&&this.grid&&this._binding&&(i=this.grid.collectionView,i&&i.sourceCollection&&i.sourceCollection.length&&(u=i.sourceCollection[0],this._type=n.getType(this._binding.getValue(u)))),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"sortMemberPath",{get:function(){return this._bindingSort?this._bindingSort.path:null},set:function(t){if(t!=this.sortMemberPath){var i=n.asString(t);this._bindingSort=i?new n.Binding(i):null;this.onPropertyChanged()}},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"width",{get:function(){return this._szStar!=null?this._szStar:this.size},set:function(t){u._parseStarSize(t)!=null?(this._szStar=t,this.onPropertyChanged()):(this._szStar=null,this.size=n.asNumber(t,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"minWidth",{get:function(){return this._szMin},set:function(t){t!=this._szMin&&(this._szMin=n.asNumber(t,!0,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"maxWidth",{get:function(){return this._szMax},set:function(t){t!=this._szMax&&(this._szMax=n.asNumber(t,!0,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"renderWidth",{get:function(){return this.renderSize},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"align",{get:function(){return this._align},set:function(n){this._align!=n&&(this._align=n,this.onPropertyChanged())},enumerable:!0,configurable:!0}),u.prototype.getAlignment=function(){var t=this._align;if(t==null&&(t='',!this._map))switch(this._type){case n.DataType.Boolean:t='center';break;case n.DataType.Number:t='right'}return t},u.prototype.getIsRequired=function(){return this._required!=null?this._required:this.dataType==n.DataType.String?this.dataMap!=null||this._mask&&this._mask.length>0:!0},Object.defineProperty(u.prototype,"header",{get:function(){return this._hdr?this._hdr:this.binding},set:function(n){this._hdr!=n&&(this._hdr=n,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"dataMap",{get:function(){return this._map},set:function(i){this._map!=i&&(this._map&&this._map.mapChanged.removeHandler(this.onPropertyChanged,this),n.isArray(i)&&(i=new t.DataMap(i,null,null)),this._map=n.asType(i,t.DataMap,!0),this._map&&this._map.mapChanged.addHandler(this.onPropertyChanged,this),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"format",{get:function(){return this._fmt},set:function(n){this._fmt!=n&&(this._fmt=n,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowSorting",{get:function(){return this._getFlag(i.AllowSorting)},set:function(n){this._setFlag(i.AllowSorting,n)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"currentSort",{get:function(){var t,n;if(this.grid&&this.grid.collectionView&&this.grid.collectionView.canSort)for(t=this.grid.collectionView.sortDescriptions,n=0;n<t.length;n++)if(t[n].property==this._getBindingSort())return t[n].ascending?'+':'-';return null},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"aggregate",{get:function(){return this._agg!=null?this._agg:n.Aggregate.None},set:function(t){t!=this._agg&&(this._agg=n.asEnum(t,n.Aggregate),this.onPropertyChanged())},enumerable:!0,configurable:!0}),u.prototype._getBindingSort=function(){return this.sortMemberPath?this.sortMemberPath:this.binding?this.binding:null},u._parseStarSize=function(t){if(n.isString(t)&&t.length>0&&t[t.length-1]=='*'){var i=t.length==1?1:t.substr(0,t.length-1)*1;if(i>0&&!isNaN(i))return i}return null},u}(u);r._ctr=0;t.Column=r;e=function(n){function t(t){var r=n.call(this)||this;return r._f=i.ColumnDefault,r._data=t,r}return __extends(t,n),Object.defineProperty(t.prototype,"dataItem",{get:function(){return this._data},set:function(n){this._data=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.size},set:function(n){this.size=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderHeight",{get:function(){return this.renderSize},enumerable:!0,configurable:!0}),t}(u);t.Row=e;o=function(r){function u(){var n=r.call(this)||this;return n._level=-1,n.isReadOnly=!0,n}return __extends(u,r),Object.defineProperty(u.prototype,"level",{get:function(){return this._level},set:function(t){n.asInt(t);t!=this._level&&(this._level=t,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"hasChildren",{get:function(){if(this.grid!=null&&this._list!=null){this._list._update();var i=this.index<this._list.length-1?this._list[this.index+1]:null,r=n.tryCast(i,u),f=n.tryCast(i,t._NewRowTemplate);return i!=null&&f==null&&(r==null||r.level>this.level)}return!0},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isCollapsed",{get:function(){return this._getFlag(i.Collapsed)},set:function(t){n.asBoolean(t);t!=this.isCollapsed&&this._list!=null&&this._setCollapsed(t)},enumerable:!0,configurable:!0}),u.prototype.getGroupHeader=function(){var u=this.grid,o=u.groupHeaderFormat?u.groupHeaderFormat:n.culture.FlexGrid.groupHeaderFormat,r=n.tryCast(this.dataItem,n.collections.CollectionViewGroup),s;if(r&&o){var f=r.groupDescription.propertyName,i=r.name,t=u.getColumn(f),e=this.isContentHtml;return t&&(e=e||t.isContentHtml,t.header&&(f=t.header),t.dataMap?i=t.dataMap.getDisplayValue(i):t.format&&(i=n.Globalize.format(i,t.format))),s=r.getAggregate(n.Aggregate.CntAll,null,u.collectionView),n.format(o,{name:n.escapeHtml(f),value:e?i:n.escapeHtml(i),level:r.level,count:s})}return''},u.prototype._setCollapsed=function(r){var c=this,f=this.grid,o=f.rows,h=this.getCellRange(),s=new t.CellRangeEventArgs(f.cells,new t.CellRange(this.index,-1)),e;f.onGroupCollapsedChanging(s);if(!s.cancel){f.deferUpdate(function(){c._setFlag(i.Collapsed,r);for(var t=h.topRow+1;t<=h.bottomRow&&t>-1&&t<o.length;t++)o[t]._setFlag(i.ParentCollapsed,r),e=n.tryCast(o[t],u),e!=null&&e.isCollapsed&&(t=e.getCellRange().bottomRow)});f.onGroupCollapsedChanged(s)}},u.prototype.getCellRange=function(){for(var f,e=this._list,o=this.index,r=e.length-1,i=o+1;i<=r;i++)if(f=n.tryCast(e[i],u),f!=null&&f.level<=this.level){r=i-1;break}return new t.CellRange(o,0,r,this.grid.columns.length-1)},u}(e);t.GroupRow=o;f=function(i){function r(r,u){var f=i.call(this)||this;return f._frozen=0,f._vlen=0,f._szDef=28,f._szTot=0,f._dirty=!1,f._g=n.asType(r,t.FlexGrid),f._szDef=n.asNumber(u,!1,!0),f}return __extends(r,i),Object.defineProperty(r.prototype,"defaultSize",{get:function(){return this._szDef},set:function(t){this._szDef!=t&&(this._szDef=n.asNumber(t,!1,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"frozen",{get:function(){return this._frozen},set:function(t){t!=this._frozen&&(this._frozen=n.asNumber(t,!1,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),r.prototype.isFrozen=function(n){return n<this.frozen},Object.defineProperty(r.prototype,"minSize",{get:function(){return this._szMin},set:function(t){t!=this._szMin&&(this._szMin=n.asNumber(t,!0,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxSize",{get:function(){return this._szMax},set:function(t){t!=this._szMax&&(this._szMax=n.asNumber(t,!0,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),r.prototype.getTotalSize=function(){return this._update(),this._szTot},Object.defineProperty(r.prototype,"visibleLength",{get:function(){return this._update(),this._vlen},enumerable:!0,configurable:!0}),r.prototype.getItemAt=function(n){if(this._update(),n<=0&&this.length>0)return 0;for(var u=0,i=this.length-1,t,r;u<=i;)if(t=u+i>>>1,r=this[t],r._pos>n)i=t-1;else if(r._pos+r.renderSize<n)u=t+1;else{while(t>0&&!this[t].visible)t--;while(t<this.length-1&&!this[t].visible)t++;return t}return i},r.prototype.getNextCell=function(n,i,r){var u;switch(i){case t.SelMove.Next:for(u=n+1;u<this.length;u++)if(this[u].renderSize>0)return u;break;case t.SelMove.Prev:for(u=n-1;u>=0;u--)if(this[u].renderSize>0)return u;break;case t.SelMove.End:for(u=this.length-1;u>=0;u--)if(this[u].renderSize>0)return u;break;case t.SelMove.Home:for(u=0;u<this.length;u++)if(this[u].renderSize>0)return u;break;case t.SelMove.NextPage:return u=this.getItemAt(this[n].pos+r),u<0?this.getNextCell(n,t.SelMove.End,r):u==n&&u<this.length-1?u+1:u;case t.SelMove.PrevPage:return u=this.getItemAt(this[n].pos-r),u<0?this.getNextCell(n,t.SelMove.Home,r):u==n&&u>0?u-1:u}return n},r.prototype.canMoveElement=function(n,i){var u,f,r;if(i==n||n<0||n>=this.length||i>=this.length)return!1;for(i<0&&(i=this.length-1),u=Math.min(n,i),f=Math.max(n,i),r=u;r<=f;r++)if(!this[r].allowDragging)return!1;return this[i]instanceof t._NewRowTemplate?!1:!0},r.prototype.moveElement=function(n,t){if(this.canMoveElement(n,t)){var i=this[n];this.removeAt(n);t<0&&(t=this.length);this.insert(t,i)}},r.prototype.onCollectionChanged=function(t){t===void 0&&(t=n.collections.NotifyCollectionChangedEventArgs.reset);this._dirty=!0;this._g.invalidate();i.prototype.onCollectionChanged.call(this,t)},r.prototype.push=function(n){return n._list=this,i.prototype.push.call(this,n)},r.prototype.splice=function(n,t,r){return r&&(r._list=this),i.prototype.splice.call(this,n,t,r)},r.prototype.beginUpdate=function(){this._update();i.prototype.beginUpdate.call(this)},r.prototype._update=function(){var t;if(this._dirty&&!this.isUpdating){this._dirty=!1;var i=0,r=0,u=void 0,n=void 0;for(t=0;t<this.length;t++)n=this[t],n._idx=t,n._vidx=i,n._list=this,n._pos=r,u=n.renderSize,u>0&&(r+=u,i++);return this._vlen=i,this._szTot=r,!0}return!1},r}(n.collections.ObservableArray);t.RowColCollection=f;s=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n._firstVisible=-1,n}return __extends(i,t),i.prototype.getColumn=function(t){var i=n.isNumber(t)?t:this.indexOf(t);return i>-1?this[i]:null},i.prototype.indexOf=function(n){var i;if(n instanceof r)return t.prototype.indexOf.call(this,n);for(i=0;i<this.length;i++)if(this[i].name==n)return i;for(i=0;i<this.length;i++)if(this[i].binding==n)return i;return-1},Object.defineProperty(i.prototype,"firstVisibleIndex",{get:function(){return this._update(),this._firstVisible},enumerable:!0,configurable:!0}),i.prototype._update=function(){if(t.prototype._update.call(this)){this._firstVisible=-1;for(var n=0;n<this.length;n++)if(this[n].visible){this._firstVisible=n;break}return!0}return!1},i.prototype._updateStarSizes=function(n){for(var u,t,e=0,f,i=0;i<this.length;i++)t=this[i],t.isVisible&&(t._szStar?(e+=r._parseStarSize(t._szStar),f=t):n-=t.renderWidth);if(f){for(u=n,i=0;i<this.length;i++)t=this[i],t.isVisible&&t._szStar&&(t==f&&u>0?t._sz=u:(t._sz=Math.max(0,Math.round(r._parseStarSize(t._szStar)/e*n)),u-=t.renderWidth));return this._dirty=!0,this._update(),!0}return!1},i}(f);t.ColumnCollection=s;h=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n._maxLevel=-1,n}return __extends(i,t),Object.defineProperty(i.prototype,"maxGroupLevel",{get:function(){return this._update(),this._maxLevel},enumerable:!0,configurable:!0}),i.prototype._update=function(){var i,r;if(t.prototype._update.call(this)){for(this._maxLevel=-1,i=0;i<this.length;i++)r=n.tryCast(this[i],o),r&&r.level>this._maxLevel&&(this._maxLevel=r.level);return!0}return!1},i}(f);t.RowCollection=h})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(i){'use strict';var r=function(){function r(t,u){var f,p,s,c,v,y;if(this._row=-1,this._col=-1,this._edge=0,t instanceof Element){p=n.closest(t,'.wj-cell');s=p?p[i.GridPanel._INDEX_KEY]:null;s&&(this._row=s.row,this._col=s.col,this._rng=s.rng,this._p=s.panel,this._g=s.panel.grid);return}if(t instanceof i.FlexGrid)f=this._g=t;else if(t instanceof i.GridPanel)this._p=t,f=this._g=this._p.grid;else throw'First parameter should be a FlexGrid or GridPanel.';u=n.mouseToPage(u);this._pt=u.clone();var w=f.controlRect,b=f._szClient,rt=f.topLeftCells,ut=f._eTL,k=f.headersVisibility,d=i.HeadersVisibility,h=k&d.Row?rt.columns.getTotalSize():0,l=k&d.Column?rt.rows.getTotalSize():0,g=k&d.Column?l+ut.offsetTop:0,nt=f._eBL,ft=nt.offsetHeight;if(u.x-=w.left,u.y-=w.top,this._g.rightToLeft&&(u.x=w.width-u.x),!this._p&&u.x>=0&&u.y>=ut.offsetTop&&b&&u.x<=b.width+h&&u.y<=b.height+g&&(this._p=u.y<g?u.x<h?f.topLeftCells:f.columnHeaders:u.y<nt.offsetTop?u.x<h?f.rowHeaders:f.cells:u.x<h?f.bottomLeftCells:f.columnFooters),this._p!=null){var tt=this._p.rows,it=this._p.columns,e=this._p.cellType,o=i.CellType,a=this._p._getFrozenPos(),et=e==o.TopLeft||e==o.ColumnHeader?l:e==o.BottomLeft||e==o.ColumnFooter?ft:tt.getTotalSize(),ot=e==o.TopLeft||e==o.BottomLeft||e==o.RowHeader?h:it.getTotalSize();if(e==o.RowHeader||e==o.Cell?(u.y-=l,(u.y>a.y||a.y<=0)&&(u.y-=f._ptScrl.y,u.y+=this._p._getOffsetY())):(e==o.BottomLeft||e==o.ColumnFooter)&&(u.y-=nt.offsetTop),(e==o.ColumnHeader||e==o.Cell||e==o.ColumnFooter)&&(u.x-=h,(u.x>a.x||a.x<=0)&&(u.x-=f._ptScrl.x)),(e==o.ColumnHeader||e==o.TopLeft)&&(u.y-=g-l),this._row=u.y>et?-1:tt.getItemAt(u.y),this._col=u.x>ot?-1:it.getItemAt(u.x),this._row<0||this._col<0){this._p=null;return}this._edge=0;c=r._SZEDGE[this._g.isTouching?1:0];this._col>-1&&(v=it[this._col],u.x-v.pos<=c&&(this._edge|=1),v.pos+v.renderSize-u.x<=c&&(this._edge|=4));this._row>-1&&(y=tt[this._row],u.y-y.pos<=c&&(this._edge|=2),y.pos+y.renderSize-u.y<=c&&(this._edge|=8))}}return Object.defineProperty(r.prototype,"point",{get:function(){return this._pt},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cellType",{get:function(){return this._p?this._p.cellType:t.CellType.None},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"panel",{get:function(){return this._p},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"grid",{get:function(){return this._p?this._p.grid:null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"col",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"range",{get:function(){return this._rng||(this._rng=new i.CellRange(this._row,this._col)),this._rng},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"edgeLeft",{get:function(){return(this._edge&1)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"edgeTop",{get:function(){return(this._edge&2)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"edgeRight",{get:function(){return(this._edge&4)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"edgeBottom",{get:function(){return(this._edge&8)!=0},enumerable:!0,configurable:!0}),r}();r._SZEDGE=[5,30];i.HitTestInfo=r})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){'use strict';var i,r;(function(n){n[n.None=0]="None";n[n.Cells=1]="Cells";n[n.ColumnHeaders=2]="ColumnHeaders";n[n.RowHeaders=4]="RowHeaders";n[n.AllHeaders=6]="AllHeaders";n[n.All=7]="All"})(i=t.AllowMerging||(t.AllowMerging={}));r=function(){function r(n){this._g=n}return r.prototype.getMergedRange=function(r,u,f,e){var c,g,b,v,y,nt,k,p,w;e===void 0&&(e=!0);var o,l,h=r.cellType,s=r.columns,a=r.rows,d=a[u],tt=s[f];if(d instanceof t._NewRowTemplate)return null;if(d instanceof t.GroupRow&&d.dataItem instanceof n.collections.CollectionViewGroup){if(o=new t.CellRange(u,f),tt.aggregate==n.Aggregate.None){while(o.col>0&&s[o.col-1].aggregate==n.Aggregate.None&&o.col!=s.frozen)o.col--;while(o.col2<s.length-1&&s[o.col2+1].aggregate==n.Aggregate.None&&o.col2+1!=s.frozen)o.col2++}while(o.col<f&&!s[o.col].visible)o.col++;return o.isSingleCell?null:o}c=!1;switch(this._g.allowMerging){case i.None:c=!0;break;case i.Cells:c=h!=t.CellType.Cell;break;case i.ColumnHeaders:c=h!=t.CellType.ColumnHeader&&h!=t.CellType.TopLeft;break;case i.RowHeaders:c=h!=t.CellType.RowHeader&&h!=t.CellType.TopLeft;break;case i.AllHeaders:c=h==t.CellType.Cell}if(c)return null;if(s[f].allowMerging){for(o=new t.CellRange(u,f),g=0,b=a.length-1,u>=a.frozen?e&&(h==t.CellType.Cell||h==t.CellType.RowHeader)&&(l=r._getViewRange(),g=l.topRow,b=l.bottomRow):b=a.frozen-1,v=u-1;v>=g&&this._mergeCell(r,v,f,u,f);v--)o.row=v;for(y=u+1;y<=b&&this._mergeCell(r,u,f,y,f);y++)o.row2=y;while(o.row<u&&!a[o.row].visible)o.row++;if(!o.isSingleCell)return o}if(a[u].allowMerging){for(o=new t.CellRange(u,f),nt=0,k=s.length-1,f>=s.frozen?e&&(h==t.CellType.Cell||h==t.CellType.ColumnHeader)&&(l=r._getViewRange(),nt=l.leftCol,k=l.rightCol):k=s.frozen-1,p=f-1;p>=nt&&this._mergeCell(r,u,p,u,f);p--)o.col=p;for(w=f+1;w<=k&&this._mergeCell(r,u,f,u,w);w++)o.col2=w;while(o.col<f&&!s[o.col].visible)o.col++;if(!o.isSingleCell)return o}return null},r.prototype._mergeCell=function(n,i,r,u,f){var e=n.rows[i],o=n.rows[u];return e instanceof t.GroupRow||e instanceof t._NewRowTemplate||o instanceof t.GroupRow||o instanceof t._NewRowTemplate?!1:i!=u&&n.rows.isFrozen(i)!=n.rows.isFrozen(u)?!1:r!=f&&n.columns.isFrozen(r)!=n.columns.isFrozen(f)?!1:i!=u&&(r>0&&(e.allowMerging&&this._mergeCell(n,i,r-1,i,r)||o.allowMerging&&this._mergeCell(n,u,r-1,u,r))||f<n.columns.length-1&&(e.allowMerging&&this._mergeCell(n,i,f,i,f+1)||o.allowMerging&&this._mergeCell(n,u,f,u,f+1)))?!1:n.getCellData(i,r,!0)!=n.getCellData(u,f,!0)?!1:!0},r}();t.MergeManager=r})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){'use strict';var i=function(){function t(t,i,r){var f,u;if(this.mapChanged=new n.Event,n.isArray(t)&&!i&&!r){for(f=[],u=0;u<t.length;u++)f.push({value:t[u]});t=f;i=r='value'}this._cv=n.asCollectionView(t);this._keyPath=n.asString(i,!1);this._displayPath=n.asString(r,!1);this._cv.collectionChanged.addHandler(this.onMapChanged,this)}return Object.defineProperty(t.prototype,"sortByDisplayValues",{get:function(){return this._sortByKey!=!0},set:function(t){this._sortByKey=!n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValuePath",{get:function(){return this._keyPath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMemberPath",{get:function(){return this._displayPath},enumerable:!0,configurable:!0}),t.prototype.getKeyValue=function(n){var t=this._indexOf(n,this._displayPath,!1);return t>-1?this._cv.sourceCollection[t][this._keyPath]:null},t.prototype.getDisplayValue=function(n){var t,i,r;if(!this._hash&&(this._hash={},t=this._cv.sourceCollection,t&&this._keyPath&&this._displayPath))for(i=t.length-1;i>=0;i--){var u=t[i],f=u[this._keyPath],e=u[this._displayPath];this._hash[f]=e}return r=this._hash[n],r!=null?r:n},t.prototype.getDisplayValues=function(){var i=[],t,n;if(this._cv&&this._displayPath)for(t=this._cv.items,n=0;n<t.length;n++)i.push(t[n][this._displayPath]);return i},t.prototype.getKeyValues=function(){var i=[],t,n;if(this._cv&&this._keyPath)for(t=this._cv.items,n=0;n<t.length;n++)i.push(t[n][this._keyPath]);return i},Object.defineProperty(t.prototype,"isEditable",{get:function(){return this._editable},set:function(t){this._editable=n.asBoolean(t)},enumerable:!0,configurable:!0}),t.prototype.onMapChanged=function(n){this._hash=null;this.mapChanged.raise(this,n)},t.prototype._indexOf=function(n,t,i){var u=-1,e=-1,r,s,f;if(this._cv&&t){var o=n!=null?n.toString():'',h=i?o:o.toLowerCase(),c=this._cv.sourceCollection;for(r=0;r<c.length;r++)if(s=c[r],f=s[t],f==n?u=r:i||f.length!=h.length||f.toLowerCase()!=h?f!=null&&f.toString()==o&&(u=r):u=r,u==r){if(!this._cv.filter||this._cv.filter(s))return u;e<0&&(e=u)}}return e},t}();t.DataMap=i})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){'use strict';var r,f,i,u;(function(n){n[n.None=0]="None";n[n.Cell=1]="Cell";n[n.CellRange=2]="CellRange";n[n.Row=3]="Row";n[n.RowRange=4]="RowRange";n[n.ListBox=5]="ListBox"})(r=t.SelectionMode||(t.SelectionMode={})),function(n){n[n.None=0]="None";n[n.Selected=1]="Selected";n[n.Cursor=2]="Cursor"}(f=t.SelectedState||(t.SelectedState={})),function(n){n[n.None=0]="None";n[n.Next=1]="Next";n[n.Prev=2]="Prev";n[n.NextPage=3]="NextPage";n[n.PrevPage=4]="PrevPage";n[n.Home=5]="Home";n[n.End=6]="End";n[n.NextCell=7]="NextCell";n[n.PrevCell=8]="PrevCell"}(i=t.SelMove||(t.SelMove={}));u=function(){function u(n){this._sel=new t.CellRange(0,0);this._mode=r.CellRange;this._g=n}return Object.defineProperty(u.prototype,"selectionMode",{get:function(){return this._mode},set:function(n){var u,i,f,e;if(n!=this._mode){if(n==r.ListBox||this._mode==r.ListBox)for(u=this._g.rows,i=0;i<u.length;i++)f=u[i],e=n==r.ListBox?this._sel.containsRow(i):!1,f._setFlag(t.RowColFlags.Selected,e,!0);switch(n){case r.None:this._sel.setRange(-1,-1);break;case r.Cell:this._sel.row2=this._sel.row;this._sel.col2=this._sel.col;break;case r.Row:this._sel.row2=this._sel.row}this._mode=n;this._g.invalidate()}},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"selection",{get:function(){return this._sel},set:function(n){this.select(n)},enumerable:!0,configurable:!0}),u.prototype.select=function(i,u){var h,c,o,l;u===void 0&&(u=!0);n.isNumber(i)&&n.isNumber(u)&&(i=new t.CellRange(i,u),u=!0);i=n.asType(i,t.CellRange);var f=this._g,a=this._sel,e=i,s=!1;switch(f.selectionMode){case r.Cell:i.row2=i.row;i.col2=i.col;break;case r.Row:i.row2=i.row;break;case r.ListBox:s=!0}if(h=e.equals(a),s&&e.row>-1&&!f.rows[e.row].isSelected&&(h=!1),h){u&&f.scrollIntoView(e.row,e.col);return}if(c=new t.CellRangeEventArgs(f.cells,e),f.onSelectionChanging(c)){if(s){for(o=0;o<f.rows.length;o++)f.rows[o]._setFlag(t.RowColFlags.Selected,e.containsRow(o),!0);f.refreshCells(!1,!0,!0)}e.row=Math.min(e.row,f.rows.length-1);e.row2=Math.min(e.row2,f.rows.length-1);this._sel=e;f.refreshCells(!1,!0,!0);u&&f.scrollIntoView(e.row,e.col);f.collectionView&&(l=f._getCvIndex(e.row),f.collectionView.moveCurrentToPosition(l));f.onSelectionChanged(c)}},u.prototype.moveSelection=function(n,r,u){var e,f,h=this._g,l=h.rows,c=h.columns,o=this._getReferenceCell(n,r,u),s=Math.max(0,h._szClient.height-h.columnHeaders.height),a;r==i.NextCell?(f=c.getNextCell(o.col,i.Next,s),e=o.row,f==o.col&&(e=l.getNextCell(e,i.Next,s),e>o.row&&(f=c.getNextCell(0,i.Next,s),f=c.getNextCell(f,i.Prev,s))),h.select(e,f)):r==i.PrevCell?(f=c.getNextCell(o.col,i.Prev,s),e=o.row,f==o.col&&(e=l.getNextCell(e,i.Prev,s),e<o.row&&(f=c.getNextCell(c.length-1,i.Prev,s),f=c.getNextCell(f,i.Next,s))),h.select(e,f)):(e=l.getNextCell(o.row,n,s),f=c.getNextCell(o.col,r,s),u?(a=h._selHdl._sel,h.select(new t.CellRange(e,f,a.row2,a.col2))):h.select(e,f))},u.prototype._getReferenceCell=function(n,t){var f=this._g,u=f._selHdl._sel,r=f.getMergedRange(f.cells,u.row,u.col);if(!r||r.isSingleCell)return u;r=r.clone();switch(n){case i.Next:case i.NextCell:r.row=r.bottomRow;break;case i.None:r.row=u.row}switch(t){case i.Next:case i.NextCell:r.col=r.rightCol;break;case i.None:r.col=u.col}return r},u.prototype._adjustSelection=function(n){switch(this._mode){case r.Cell:return new t.CellRange(n.row,n.col,n.row,n.col);case r.Row:return new t.CellRange(n.row,0,n.row,this._g.columns.length-1);case r.RowRange:case r.ListBox:return new t.CellRange(n.row,0,n.row2,this._g.columns.length-1)}return n},u}();t._SelectionHandler=u})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){'use strict';var i,r;(function(n){n[n.None=0]="None";n[n.MoveDown=1]="MoveDown";n[n.MoveAcross=2]="MoveAcross";n[n.Cycle=3]="Cycle"})(i=t.KeyAction||(t.KeyAction={}));r=function(){function r(n){this._kaTab=i.None;this._kaEnter=i.MoveDown;this._g=n;var t=n.hostElement;n.addEventListener(t,'keypress',this._keypress.bind(this));n.addEventListener(t,'keydown',this._keydown.bind(this))}return r.prototype._keydown=function(i){var r=this._g,e=r.selection,s=i.ctrlKey||i.metaKey,o=i.shiftKey,b=i.target,f=!0,y,w,p,u,h,v;if((this._altDown=!1,r.isRangeValid(e)&&!i.defaultPrevented)&&!r._wantsInput(i.target)&&(!r.activeEditor||!r._edtHdl._keydown(i))){var a=n.tryCast(r.rows[e.row],t.GroupRow),c=r.editableCollectionView,l=i.keyCode;if(r.autoClipboard){if(s&&(l==67||l==45)){if(y=new t.CellRangeEventArgs(r.cells,e),r.onCopying(y)){w=r.getClipString()+'\r\n';n.Clipboard.copy(w);r.onCopied(y)}i.stopPropagation();return}if(s&&l==86||o&&l==45){r.isReadOnly||(p=new t.CellRangeEventArgs(r.cells,e),r.onPasting(p)&&n.Clipboard.paste(function(n){r.setClipString(n);r.onPasted(p)}));i.stopPropagation();return}}if(r.rightToLeft)switch(l){case n.Key.Left:l=n.Key.Right;break;case n.Key.Right:l=n.Key.Left}u=t.SelMove;h=t.SelectionMode;switch(l){case n.Key.Space:if(o&&e.isValid)switch(r.selectionMode){case h.CellRange:case h.Row:case h.RowRange:case h.ListBox:r.select(new t.CellRange(e.row,0,e.row,r.columns.length-1))}else if(s&&e.isValid)switch(r.selectionMode){case h.CellRange:r.select(new t.CellRange(0,e.col,r.rows.length-1,e.col))}else f=this._startEditing(!0,i),f&&setTimeout(function(){var t=r.activeEditor;t&&(t.disabled||t.readOnly?r.finishEditing():t.type=='checkbox'?(t.checked=!t.checked,r.finishEditing()):n.setSelectionRange(t,t.value.length))});break;case 65:if(s)switch(r.selectionMode){case h.CellRange:case h.Row:case h.RowRange:case h.ListBox:r.select(new t.CellRange(0,0,r.rows.length-1,r.columns.length-1))}else f=!1;break;case n.Key.Left:s||i.altKey?f=!1:e.isValid&&e.col==0&&a!=null&&!a.isCollapsed&&a.hasChildren?a.isCollapsed=!0:this._moveSel(u.None,s?u.Home:u.Prev,o);break;case n.Key.Right:s||i.altKey?f=!1:e.isValid&&e.col==0&&a!=null&&a.isCollapsed?a.isCollapsed=!1:this._moveSel(u.None,s?u.End:u.Next,o);break;case n.Key.Up:s?f=!1:(this._altDown=i.altKey,i.altKey?f=r._edtHdl._toggleListBox(i):this._moveSel(u.Prev,u.None,o));break;case n.Key.Down:s?f=!1:(this._altDown=i.altKey,i.altKey?f=r._edtHdl._toggleListBox(i):this._moveSel(u.Next,u.None,o));break;case n.Key.PageUp:this._altDown=i.altKey;this._moveSel(i.altKey?u.Home:u.PrevPage,u.None,o);break;case n.Key.PageDown:this._altDown=i.altKey;this._moveSel(i.altKey?u.End:u.NextPage,u.None,o);break;case n.Key.Home:this._moveSel(s?u.Home:u.None,u.Home,o);break;case n.Key.End:this._moveSel(s?u.End:u.None,u.End,o);break;case n.Key.Tab:f=this._performKeyAction(r.keyActionTab,o);break;case n.Key.Enter:f=this._performKeyAction(r.keyActionEnter,o);!o&&c&&c.currentEditItem!=null&&r._edtHdl._commitRowEdits();break;case n.Key.Escape:if(f=!1,c&&(c.currentAddItem||c.currentEditItem)){v=new t.CellRangeEventArgs(r.cells,r.selection);v.cancel=!0;r.onRowEditEnding(v);c.currentAddItem&&c.cancelNew();c.currentEditItem&&c.cancelEdit();r.onRowEditEnded(v);f=!0}r._mouseHdl.resetMouseState();break;case n.Key.Delete:case n.Key.Back:f=this._deleteSel(i);break;case n.Key.F2:f=this._startEditing(!0,i);break;case n.Key.F4:f=r._edtHdl._toggleListBox(i);break;default:f=!1}f&&(r.containsFocus()||r.focus(),i.preventDefault(),i.stopPropagation())}},r.prototype._performKeyAction=function(n,r){var u=t.SelMove;switch(n){case i.MoveDown:return this._moveSel(r?u.Prev:u.Next,u.None,!1),!0;case i.MoveAcross:return this._moveSel(u.None,r?u.Prev:u.Next,!1),!0;case i.Cycle:return this._moveSel(u.None,r?u.PrevCell:u.NextCell,!1),!0}return!1},r.prototype._keypress=function(t){var i=this._g;if(!i._wantsInput(t.target)&&!t.defaultPrevented){if(this._altDown){t.preventDefault();return}i.activeEditor?i._edtHdl._keypress(t):t.charCode>n.Key.Space&&this._startEditing(!1,t)&&i.activeEditor&&setTimeout(function(){var r=i.activeEditor;if(r&&r.type!='checkbox'){var u=i.selection,f=i.getCellData(u.row,u.col,!0),e=i.getCellData(u.row,u.col,!1);r.value=String.fromCharCode(t.charCode);n.isNumber(e)&&f.indexOf('%')>-1&&(r.value+='%');n.setSelectionRange(r,1);r.dispatchEvent(i._edtHdl._evtInput);i._edtHdl._keypress(t)}});t.stopPropagation()}},r.prototype._moveSel=function(n,i,r){this._g.selectionMode!=t.SelectionMode.None&&this._g._selHdl.moveSelection(n,i,r)},r.prototype._deleteSel=function(n){var i=this._g,u=i.editableCollectionView,f=i.selection,h=i.rows,e=[],v=new t.CellRange,c=new t.CellEditEndingEventArgs(i.cells,v,n),r,l,a,o,y,s,p;if(i.allowDelete&&!i.isReadOnly&&(u==null||u.canRemove&&!u.isAddingNew&&!u.isEditingItem))switch(i.selectionMode){case t.SelectionMode.CellRange:if(f.leftCol==0&&f.rightCol==i.columns.length-1)for(r=f.topRow;r>-1&&r<=f.bottomRow;r++)e.push(h[r]);break;case t.SelectionMode.ListBox:for(r=0;r<h.length;r++)h[r].isSelected&&e.push(h[r]);break;case t.SelectionMode.Row:f.topRow>-1&&e.push(h[f.topRow]);break;case t.SelectionMode.RowRange:for(r=f.topRow;r>-1&&r<=f.bottomRow;r++)e.push(h[r])}if(e.length>0){for(u&&u.beginUpdate(),i.beginUpdate(),r=e.length-1;r>=0;r--)if(l=e[r],v.setRange(l.index,-1),i.onDeletingRow(c)){u&&l.dataItem?u.remove(l.dataItem):i.rows.removeAt(l.index);i.onDeletedRow(c)}return i.endUpdate(),u&&u.endUpdate(),i.selectionMode==t.SelectionMode.ListBox&&(a=i.selection.row,a>-1&&a<i.rows.length&&(i.rows[a].isSelected=!0)),i.childItemsPath&&i.collectionView&&i.collectionView.refresh(),!0}if(!i.isReadOnly&&e.length==0){for(u&&u.beginUpdate(),i.beginUpdate(),o=f.topRow;o<=f.bottomRow;o++)if(y=i.rows[o],!y.isReadOnly)for(s=f.leftCol;s<=f.rightCol;s++)if(p=i._getBindingColumn(i.cells,o,i.columns[s]),!p.getIsRequired()&&!p.isReadOnly&&i.getCellData(o,s,!0)&&(v.setRange(o,s),c.cancel=!1,i.onBeginningEdit(c))){u&&u.editItem(y.dataItem);i.setCellData(o,s,'',!0,!1);i.onCellEditEnding(c);i.onCellEditEnded(c)}return u&&(i._edtHdl._edItem=u.currentEditItem,u.endUpdate()),i.endUpdate(),i.selection=f,!0}return!1},r.prototype._startEditing=function(n,t,i,r){return this._g._edtHdl.startEditing(n,i,r,!0,t)},r}();t._KeyboardHandler=r})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){'use strict';var i=4,e='wj-state-dragsrc',r,o,u,f;(function(n){n[n.None=0]="None";n[n.Columns=1]="Columns";n[n.Rows=2]="Rows";n[n.Both=3]="Both";n[n.ColumnsAllCells=n.Columns|i]="ColumnsAllCells";n[n.RowsAllCells=n.Rows|i]="RowsAllCells";n[n.BothAllCells=n.Both|i]="BothAllCells"})(r=t.AllowResizing||(t.AllowResizing={})),function(n){n[n.None=0]="None";n[n.Headers=1]="Headers";n[n.Cells=2]="Cells";n[n.Both=3]="Both"}(o=t.AutoSizeMode||(t.AutoSizeMode={})),function(n){n[n.None=0]="None";n[n.Columns=1]="Columns";n[n.Rows=2]="Rows";n[n.Both=3]="Both"}(u=t.AllowDragging||(t.AllowDragging={}));f=function(){function f(i){var u=this,r,f,e;this._tsLast=0;r=i.hostElement;this._g=i;this._dvMarker=n.createElement('<div class="wj-marker">&nbsp;</div>');i.addEventListener(r,'mousedown',function(r){var s,o,h;if(i._rcBounds=null,!r.defaultPrevented&&r.button==0){if(i.focus(),setTimeout(function(){r.defaultPrevented||i.focus()}),s=r.target,!i.activeEditor&&i._isInputElement(s)){if(n.getActiveElement()!=s&&s.tagName!='OPTION'){o=i.hitTest(r);switch(o.cellType){case t.CellType.Cell:i.select(o.range);break;case t.CellType.ColumnHeader:case t.CellType.ColumnFooter:i.scrollIntoView(-1,o.col);break;case t.CellType.RowHeader:i.scrollIntoView(o.row,-1)}}return}h=n.closest(r.target,'.wj-flexgrid');h&&h!=i.hostElement||u._isDown||(u._isDown=!0,i.addEventListener(document,'mousemove',f),i.addEventListener(document,'mouseup',e),u._mousedown(r))}});f=function(n){u._mousemove(n)};e=function(n){u._isDown=!1;i.removeEventListener(document,'mousemove');i.removeEventListener(document,'mouseup');u._mouseup(n)};i.addEventListener(r,'mousemove',this._hover.bind(this));i.addEventListener(r,'dblclick',this._dblclick.bind(this));i.addEventListener(r,'click',this._click.bind(this));i.addEventListener(r,'selectstart',function(n){i._isInputElement(n.target)||n.preventDefault()});i.addEventListener(r,'wheel',function(t){var r=i.cells.hostElement.parentElement;t.deltaY&&!t.ctrlKey&&!t.metaKey&&r.scrollHeight>r.offsetHeight&&n.closest(t.target,'.wj-flexgrid')==i.hostElement&&(r.scrollTop+=120*(t.deltaY<0?-1:1),t.preventDefault(),t.stopImmediatePropagation())});i.addEventListener(r,'dragstart',this._dragstart.bind(this));i.addEventListener(r,'dragover',this._dragover.bind(this));i.addEventListener(r,'dragleave',this._dragover.bind(this));i.addEventListener(r,'drop',this._drop.bind(this));i.addEventListener(r,'dragend',this._dragend.bind(this))}return f.prototype.resetMouseState=function(){var t,i;this._dragSource&&n.removeClass(this._dragSource,e);this._showDragMarker(null);t=this._g.hostElement;t&&(t.style.cursor=null);i=this._g;i.removeEventListener(document,'mousemove');i.removeEventListener(document,'mouseup');this._tsLast=Date.now();this._eMouse=null;this._isDown=null;this._htDown=null;this._lbSelRows=null;this._szRowCol=null;this._szArgs=null;this._dragSource=null},f.prototype._mousedown=function(i){var r=this._g,f=r.hitTest(i),o=f.cellType,s,e;if(this._selDown=r.selection,f.panel==r.cells){if(n.closest(i.target,'.'+t.CellFactory._WJC_DROPDOWN)){i.preventDefault();r._edtHdl._toggleListBox(i,f.range);return}if(r.editRange&&r.editRange.contains(f.range))return}if(s=n.getActiveElement(),i.target!=s||!r._isInputElement(i.target)){if(o==t.CellType.None){r._edtHdl._commitRowEdits();return}if(this._htDown=f,this._eMouse=i,this._szRowCol!=null){this._handleResizing(i);return}switch(o){case t.CellType.Cell:i.ctrlKey&&r.selectionMode==t.SelectionMode.ListBox&&this._startListBoxSelection(f.row);this._mouseSelect(i,i.shiftKey);break;case t.CellType.RowHeader:(this._g.allowDragging&u.Rows)==0&&(i.ctrlKey&&r.selectionMode==t.SelectionMode.ListBox&&this._startListBoxSelection(f.row),this._mouseSelect(i,i.shiftKey))}if(o==t.CellType.Cell&&r.rows.maxGroupLevel>-1&&n.closest(i.target,'.'+t.CellFactory._WJC_COLLAPSE)&&(e=n.tryCast(r.rows[f.row],t.GroupRow),e)){i.ctrlKey?r.collapseGroupsToLevel(e.isCollapsed?e.level+1:e.level):e.isCollapsed=!e.isCollapsed;this.resetMouseState();return}}},f.prototype._mousemove=function(n){if(this._htDown!=null){if(n.buttons==0&&this._eMouse&&n.timeStamp-this._eMouse.timeStamp>600){this.resetMouseState();return}if(this._eMouse=n,this._szRowCol)this._handleResizing(n);else switch(this._htDown.cellType){case t.CellType.Cell:this._mouseSelect(n,!0);break;case t.CellType.RowHeader:(this._g.allowDragging&u.Rows)==0&&this._mouseSelect(n,!0)}}},f.prototype._mouseup=function(n){if(!this._dragSource||!this._g.isTouching){var r=this._g,u=r.hitTest(n),i=this._htDown,f=t.SelectionMode;if(i&&!n.defaultPrevented)if(this._szArgs)this._finishResizing(n);else if(i.panel!=r.topLeftCells||this._szArgs)i.panel!=r.columnHeaders||n.dataTransfer?i.panel==r.cells&&(n.ctrlKey||n.metaKey||n.shiftKey||u.panel==i.panel&&u.range.equals(i.range)&&r.selection.equals(this._selDown)&&r.startEditing(!0)):u.panel==i.panel&&u.col==i.col&&!u.edgeRight&&u.col>-1&&this._clickSort(n,u);else if(u.panel==i.panel&&u.row==i.row&&u.col==i.col)switch(r.selectionMode){case f.CellRange:case f.RowRange:case f.ListBox:r.select(new t.CellRange(0,0,r.rows.length-1,r.columns.length-1))}this.resetMouseState()}},f.prototype._click=function(n){Date.now()-this._tsLast>50&&this._handleClick(n)},f.prototype._handleClick=function(i){var r=this._g,e=i.target,u=new t.HitTestInfo(e,null),f;i.defaultPrevented||u.grid!=r||r._isInputElement(e)||(u.panel==r.topLeftCells?r.select(new t.CellRange(0,0,r.rows.length-1,r.columns.length-1)):u.panel==r.columnHeaders?this._clickSort(i,u):u.panel==r.rowHeaders?r.select(new t.CellRange(u.row,0,u.row,r.columns.length-1)):u.panel==r.cells&&(u.row<0?this._clickSort(i,u):n.closest(e,'.'+t.CellFactory._WJC_COLLAPSE)?(f=r.rows[u.row],f instanceof n.grid.GroupRow&&(i.ctrlKey?r.collapseGroupsToLevel(f.isCollapsed?f.level+1:f.level):f.isCollapsed=!f.isCollapsed)):n.closest(e,'.'+t.CellFactory._WJC_DROPDOWN)?r._edtHdl._toggleListBox(i,u.range):r.select(u.range)))},f.prototype._clickSort=function(i,r){var u=this._g,c=u.collectionView,f,o,s,h;if(c&&c.canSort&&u.allowSorting){var l=r.range.bottomRow,a=r.panel.columns[r.col],e=u._getBindingColumn(r.panel,r.row,a);if((!(l>-1)||l==u._getSortRowIndex()||a!=e)&&e.allowSorting&&e.binding){for(f=r.grid.collectionView.sortDescriptions,o=null,s=0;s<f.length;s++)if(f[s].property==e.binding){o=!f[s].ascending;break}if(o==null){if(i.ctrlKey)return;o=!0}if(h=new t.CellRangeEventArgs(r.panel,r.range),u.onSortingColumn(h)){u._edtHdl._commitRowEdits();i.ctrlKey?f.clear():f.splice(0,f.length,new n.collections.SortDescription(e._getBindingSort(),o));u.onSortedColumn(h)}}}},f.prototype._dblclick=function(n){var u=this._g,e=u.hitTest(n),o=e.cellType,l=u.selection,s=e.range,f,h,c,a;if(!n.defaultPrevented){if(e.edgeRight&&u.allowResizing&r.Columns){if(o==t.CellType.ColumnHeader||o==t.CellType.Cell&&u.allowResizing&i){for(n.preventDefault(),n.ctrlKey&&l.containsColumn(e.col)&&(s=l),h=s.leftCol;h<=s.rightCol;h++)if(u.columns[h].allowResizing&&(f=new t.CellRangeEventArgs(u.cells,new t.CellRange(-1,h)),u.onAutoSizingColumn(f)&&u.onResizingColumn(f))){u.autoSizeColumn(h);u.onResizedColumn(f);u.onAutoSizedColumn(f)}}else if(o==t.CellType.TopLeft&&e.panel.columns[e.col].allowResizing&&(n.preventDefault(),f=new t.CellRangeEventArgs(e.panel,new t.CellRange(-1,e.col)),u.onAutoSizingColumn(f)&&u.onResizingColumn(f))){u.autoSizeColumn(e.col,!0);u.onAutoSizedColumn(f);u.onResizedColumn(f)}this.resetMouseState();return}if(e.edgeBottom&&u.allowResizing&r.Rows){if(o==t.CellType.RowHeader||o==t.CellType.Cell&&u.allowResizing&i){for(n.ctrlKey&&l.containsRow(e.row)&&(s=l),c=s.topRow;c<=s.bottomRow;c++)if(u.rows[c].allowResizing&&(f=new t.CellRangeEventArgs(u.cells,new t.CellRange(c,-1)),u.onAutoSizingRow(f)&&u.onResizingRow(f))){u.autoSizeRow(c);u.onResizedRow(f);u.onAutoSizedRow(f)}}else if(o==t.CellType.TopLeft&&e.panel.rows[e.row].allowResizing&&(f=new t.CellRangeEventArgs(e.panel,new t.CellRange(e.row,-1)),u.onAutoSizingRow(f)&&u.onResizingRow(f))){u.autoSizeRow(e.row,!0);u.onResizedRow(f);u.onAutoSizedRow(f)}this.resetMouseState();return}if(o==t.CellType.Cell&&!u.activeEditor&&!u._isInputElement(n.target)&&(a=u._selHdl.selection,e.range.contains(a))){u.startEditing(!0);this.resetMouseState();return}}},f.prototype._hover=function(n){if(this._htDown==null){var f=this._g,u=f.hitTest(n),s=u.panel,e=u.cellType,o='default';return this._szRowCol=null,(e==t.CellType.ColumnHeader||e==t.CellType.TopLeft||e==t.CellType.Cell&&f.allowResizing&i)&&u.edgeRight&&(f.allowResizing&r.Columns)!=0&&(this._szRowCol=this._getResizeCol(u)),(e==t.CellType.RowHeader||e==t.CellType.TopLeft||e==t.CellType.Cell&&f.allowResizing&i)&&u.edgeBottom&&(f.allowResizing&r.Rows)!=0&&(this._szRowCol=this._getResizeRow(u)),this._szRowCol instanceof t.Column?o='col-resize':this._szRowCol instanceof t.Row&&(o='row-resize'),this._szStart=this._szRowCol?this._szRowCol.renderSize:0,f.hostElement.style.cursor=o,u}return null},f.prototype._getResizeCol=function(n){for(var i,r=n.panel.columns,f=r[n.col],u=n.col+1;u<r.length;u++)if(i=r[u],i.visible){i.size<1&&(f=i);break}if(n.col==r.length-1&&(n.cellType==t.CellType.TopLeft||n.cellType==t.CellType.RowHeader))for(r=this._g.columns,u=0;u<r.length;u++)if(i=r[u],i.visible){i.size<1&&(f=i);break}return f.allowResizing?f:null},f.prototype._getResizeRow=function(n){for(var i,r=n.panel.rows,f=r[n.row],u=n.row+1;u<r.length;u++)if(i=r[u],i.visible){i.size<1&&(f=i);break}if(n.row==r.length-1&&(n.cellType==t.CellType.TopLeft||n.cellType==t.CellType.ColumnHeader))for(r=this._g.rows,u=0;u<r.length;u++)if(i=r[u],i.visible){i.size<1&&(f=i);break}return f.allowResizing?f:null},f.prototype._mouseSelect=function(i,r){var f=this,e=this._g,u;this._htDown&&this._htDown.panel&&e.selectionMode!=t.SelectionMode.None&&(u=new t.HitTestInfo(this._htDown.panel,i),this._handleSelection(u,r),!n.isIE9()&&i.button>=0&&(u=new t.HitTestInfo(e,i),u.cellType!=t.CellType.Cell&&u.cellType!=t.CellType.RowHeader&&setTimeout(function(){f._mouseSelect(f._eMouse,r)},100)))},f.prototype._handleResizing=function(n){var u;if(n.preventDefault(),this._szRowCol instanceof t.Column){var i=this._g,e=n.clientX+pageXOffset,r=Math.round(Math.max(f._SZ_MIN,this._szStart+(e-this._htDown.point.x)*(i.rightToLeft?-1:1)));this._szRowCol.renderSize!=r&&(this._szArgs==null&&(u=i.rowHeaders.columns.indexOf(this._szRowCol)>-1?i.rowHeaders:i.cells,this._szArgs=new t.CellRangeEventArgs(u,new t.CellRange(-1,this._szRowCol.index))),this._szArgs.cancel=!1,i.onResizingColumn(this._szArgs)&&(i.deferResizing||i.isTouching?this._showResizeMarker(r):this._szRowCol.width=r))}if(this._szRowCol instanceof t.Row){var i=this._g,o=n.clientY+pageYOffset,r=Math.round(Math.max(f._SZ_MIN,this._szStart+(o-this._htDown.point.y)));this._szRowCol.renderSize!=r&&(this._szArgs==null&&(u=i.columnHeaders.rows.indexOf(this._szRowCol)>-1?i.columnHeaders:i.cells,this._szArgs=new t.CellRangeEventArgs(u,new t.CellRange(this._szRowCol.index,-1))),this._szArgs.cancel=!1,i.onResizingRow(this._szArgs)&&(i.deferResizing||i.isTouching?this._showResizeMarker(r):this._szRowCol.height=r))}},f.prototype._dragstart=function(i){var f=this._g,r=this._htDown,o,s;r&&(this._dragSource=null,this._szRowCol||(o=new t.CellRangeEventArgs(r.panel,r.range),r.cellType==t.CellType.ColumnHeader&&f.allowDragging&u.Columns&&r.col>-1&&f.columns[r.col].allowDragging?f.onDraggingColumn(o)?this._dragSource=i.target:i.preventDefault():r.cellType==t.CellType.RowHeader&&f.allowDragging&u.Rows&&r.row>-1&&f.rows[r.row].allowDragging&&(s=f.rows[r.row],s instanceof t.GroupRow||s instanceof t._NewRowTemplate||(f.onDraggingRow(o)?this._dragSource=i.target:i.preventDefault()))),this._dragSource&&i.dataTransfer&&!i.defaultPrevented&&(n._startDrag(i.dataTransfer,'move'),i.stopPropagation(),n.addClass(this._dragSource,e),f.beginUpdate(),this._updating=!0))},f.prototype._dragend=function(){this._updating&&(this._g.endUpdate(),this._updating=!1);this.resetMouseState()},f.prototype._dragover=function(n){var r=this._g,i=r.hitTest(n),f=!1,u=new t.CellRangeEventArgs(r.cells,i.range);this._htDown&&i.cellType==this._htDown.cellType&&(i.cellType==t.CellType.ColumnHeader?(u.cancel=!r.columns.canMoveElement(this._htDown.col,i.col),f=r.onDraggingColumnOver(u)):i.cellType==t.CellType.RowHeader&&(u.cancel=!r.rows.canMoveElement(this._htDown.row,i.row),f=r.onDraggingRowOver(u)));f?(n.dataTransfer.dropEffect='move',this._showDragMarker(i),n.preventDefault(),n.stopPropagation()):this._showDragMarker(null)},f.prototype._drop=function(n){var i=this._g,r=i.hitTest(n),f=new t.CellRangeEventArgs(i.cells,r.range),u;if(this._htDown&&r.cellType==this._htDown.cellType)if(u=i.selection,r.cellType==t.CellType.ColumnHeader){i.columns.moveElement(this._htDown.col,r.col);i.select(u.row,r.col);i.onDraggedColumn(f)}else if(r.cellType==t.CellType.RowHeader){i.rows.moveElement(this._htDown.row,r.row);i.select(r.row,u.col);i.onDraggedRow(f)}this.resetMouseState()},f.prototype._showResizeMarker=function(i){var u=this._g,e=this._dvMarker,f,r;e.parentElement||u.cells.hostElement.appendChild(e);f=this._szArgs.panel.cellType;this._szRowCol instanceof t.Column?(r={display:'',left:this._szRowCol.pos+i-1,top:0,right:'',bottom:0,width:3,height:''},u.rightToLeft&&(r.left=u.cells.hostElement.clientWidth-r.left-r.width),(f==t.CellType.TopLeft||f==t.CellType.RowHeader)&&(r.left-=u.topLeftCells.hostElement.offsetWidth)):(r={left:0,top:this._szRowCol.pos+i-1,right:0,bottom:'',width:'',height:3},(f==t.CellType.TopLeft||f==t.CellType.ColumnHeader)&&(r.top-=u.topLeftCells.hostElement.offsetHeight));n.setCss(e,r)},f.prototype._showDragMarker=function(i){var f=this._g,u=this._dvMarker,r,e,o;if(!i){u.parentElement&&u.parentElement.removeChild(u);this._rngTarget=null;return}if(!i.range.equals(this._rngTarget)){this._rngTarget=i.range;u.parentElement||i.panel.hostElement.appendChild(u);r={display:'',left:0,top:0,width:6,height:6};switch(i.cellType){case t.CellType.ColumnHeader:r.height=i.panel.height;e=f.columns[i.col];r.left=e.pos-r.width/2;i.col>this._htDown.col&&(r.left+=e.renderWidth);f.rightToLeft&&(r.left=u.parentElement.clientWidth-r.left-r.width);break;case t.CellType.RowHeader:r.width=i.panel.width;o=f.rows[i.row];r.top=o.pos-r.height/2;i.row>this._htDown.row&&(r.top+=o.renderHeight)}n.setCss(u,r)}},f.prototype._finishResizing=function(n){var r=this._g,s=r.selection,c=this._eMouse.ctrlKey,i=this._szArgs,l=n.clientX+pageXOffset,a=n.clientY+pageYOffset,e,u,h,o;if(i&&!i.cancel&&i.col>-1){u=i.col;h=Math.round(Math.max(f._SZ_MIN,this._szStart+(l-this._htDown.point.x)*(this._g.rightToLeft?-1:1)));i.panel.columns[u].width=Math.round(h);r.onResizedColumn(i);if(c&&this._htDown.cellType==t.CellType.ColumnHeader&&s.containsColumn(u))for(e=s.leftCol;e<=s.rightCol;e++)if(r.columns[e].allowResizing&&e!=u&&(i=new t.CellRangeEventArgs(r.cells,new t.CellRange(-1,e)),r.onResizingColumn(i))){r.columns[e].size=r.columns[u].size;r.onResizedColumn(i)}}if(i&&!i.cancel&&i.row>-1){u=i.row;h=Math.round(Math.max(f._SZ_MIN,this._szStart+(a-this._htDown.point.y)));i.panel.rows[u].height=Math.round(h);r.onResizedRow(i);if(c&&this._htDown.cellType==t.CellType.RowHeader&&s.containsRow(u))for(o=s.topRow;o<=s.bottomRow;o++)if(r.rows[o].allowResizing&&o!=u&&(i=new t.CellRangeEventArgs(r.cells,new t.CellRange(o,-1)),r.onResizingRow(i))){r.rows[o].size=r.rows[u].size;r.onResizedRow(i)}}},f.prototype._startListBoxSelection=function(n){var i=this._g.rows,t;for(this._lbSelState=!i[n].isSelected,this._lbSelRows={},t=0;t<i.length;t++)i[t].isSelected&&(this._lbSelRows[t]=!0)},f.prototype._handleSelection=function(n,i){var r=this._g,o=r.rows,e=r._selHdl.selection,f=new t.CellRange(n.row,n.col),s,u,h,c;if(n.row>-1&&n.col>-1)if(this._lbSelRows!=null){for(s=!1,f=new t.CellRange(n.row,n.col,this._htDown.row,this._htDown.col),u=0;u<o.length;u++)if(h=f.containsRow(u)?this._lbSelState:this._lbSelRows[u]!=null,h!=o[u].isSelected&&(c=new t.CellRangeEventArgs(r.cells,new t.CellRange(u,e.col,u,e.col2)),r.onSelectionChanging(c))){o[u]._setFlag(t.RowColFlags.Selected,h,!0);s=!0;r.onSelectionChanged(c)}s&&r.refreshCells(!1,!0,!0);r.scrollIntoView(n.row,n.col)}else n.cellType==t.CellType.RowHeader&&(f.col=0,f.col2=r.columns.length-1),i&&(f.row2=e.row2,f.col2=e.col2),r.select(f)},f}();f._SZ_MIN=0;t._MouseHandler=f})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){'use strict';var i='wj-cell-check',r=function(){function r(r){var u=this;this._fullEdit=!1;this._list=null;this._g=r;this._evtInput=document.createEvent('HTMLEvents');this._evtInput.initEvent('input',!0,!1);r.selectionChanging.addHandler(function(n,t){var i;if(u.finishEditing()){if(i=r._selHdl.selection.row,i!=t.row){var f=r.rows.length,e=i>-1&&i<f?r.rows[i].dataItem:null,o=t.row>-1&&t.row<f?r.rows[t.row].dataItem:null;e!=o&&u._commitRowEdits()}}else t.cancel=!0});r.lostFocus.addHandler(function(){if(!r.containsFocus()){var t=n.getActiveElement();t&&getComputedStyle(t).position=='fixed'||u._commitRowEdits()}});r.addEventListener(r.hostElement,'mousedown',function(f){var s,o,e;f.defaultPrevented||f.button!=0||r._mouseHdl._szRowCol||(s=r.selection,o=r.hitTest(f),o.cellType!=t.CellType.Cell&&o.cellType!=t.CellType.None?u.finishEditing():o.cellType!=t.CellType.None&&(e=n.tryCast(f.target,HTMLInputElement),e&&e.type=='checkbox'&&!e.disabled&&!e.readOnly&&n.hasClass(e,i)&&n.closest(e,'.wj-flexgrid')==r.hostElement&&(f.preventDefault(),u.startEditing(!1,o.row,o.col)&&(e=u.activeEditor,!e||e.type!='checkbox'||e.disabled||e.readOnly||(e.checked=!e.checked,e.focus(),u.finishEditing())))))},!0)}return r.prototype.startEditing=function(i,r,u,f,e){var o,h,c,l,v,a,y,s;if((i===void 0&&(i=!0),o=this._g,r=n.asNumber(r,!0,!0),u=n.asNumber(u,!0,!0),r==null&&(r=o.selection.row),u==null&&(u=o.selection.col),f==null&&(f=!0),!this._allowEditing(r,u))||(h=o.getMergedRange(o.cells,r,u),h||(h=new t.CellRange(r,u)),c=o.rows[r].dataItem,o.select(h,!0),!o.rows[r]||c!=o.rows[r].dataItem))return!1;if(h.equals(this._rng))return!0;if(this.activeEditor&&!this.finishEditing()||(l=new t.CellRangeEventArgs(o.cells,h,e),!o.onBeginningEdit(l)))return!1;if(v=o.editableCollectionView,a=!1,v){if(c=o.rows[r].dataItem,a=c!=v.currentEditItem,a)o.onRowEditStarting(l);if(v.editItem(c),a){o.onRowEditStarted(l);this._edItem=c}}if(this._fullEdit=n.asBoolean(i),this._rng=h,this._list=null,y=o.columns[u].dataMap,y&&(this._list=y.getDisplayValues(c)),h.isSingleCell?this._updateEditorCell(r,u,a):o.refresh(!1),s=this._edt,s){s.type=='checkbox'?this._fullEdit=!1:f&&n.setSelectionRange(s,0,s.value.length);o.onPrepareCellForEdit(l);if(s=this._edt,!s||s.disabled||s.readOnly)return!1;s&&f&&s.focus()}return!0},r.prototype.finishEditing=function(i){var e,c,l,h,p,o,s,a;if(i===void 0&&(i=!1),e=this._edt,!e)return this._removeListBox(),!0;var r=this._g,u=this._rng,f=new t.CellEditEndingEventArgs(r.cells,u),v=r.containsFocus(),y=r.hostElement.querySelector('.wj-control.wj-state-focused');if(y&&(c=n.Control.getControl(y),c))c.onLostFocus(f);if(f.cancel=i,!i&&r.validateEdits&&(l=this._getValidationError(),l&&(f.cancel=!0,h=e.parentElement,h&&(n.toggleClass(h,'wj-state-invalid',!0),h.title=l,f.stayInEditMode=!0))),!r.onCellEditEnding(f)&&f.stayInEditMode)return v?setTimeout(function(){e.select()}):e.select(),!1;if(!f.cancel)for(f.data=r.cells.getCellData(u.topRow,u.leftCol,!1),p=r.cellFactory.getEditorValue(r),o=u.topRow;o<=u.bottomRow&&o<r.rows.length;o++)for(s=u.leftCol;s<=u.rightCol&&s<r.columns.length;s++)r.cells.setCellData(o,s,p,!0,!1);this._edt=null;this._rng=null;this._list=null;this._removeListBox();a=n.closest(e,'.wj-cell');n.contains(a,n.getActiveElement())&&a.focus();i?this._updateEditorCell(u.row,u.col,!1):r.refresh(!1);v&&r.focus();r.onCellEditEnded(f);return!0},Object.defineProperty(r.prototype,"activeEditor",{get:function(){return this._edt},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"editRange",{get:function(){return this._rng},enumerable:!0,configurable:!0}),r.prototype.getClipString=function(i){var r=this._g,u='',c=!0,e,o,s,h,f;if(!i){i=r.selection;switch(r.selectionMode){case t.SelectionMode.Row:case t.SelectionMode.RowRange:i.col=0;i.col2=r.columns.length-1;break;case t.SelectionMode.ListBox:for(i.col=0,i.col2=r.columns.length-1,e=0;e<r.rows.length;e++)r.rows[e].isSelected&&r.rows[e].isVisible&&(i.row=i.row2=e,u&&(u+='\n'),u+=this.getClipString(i));return u}}for(i=n.asType(i,t.CellRange),o=i.topRow;o<=i.bottomRow;o++)if(r.rows[o].isVisible)for(c||(u+='\n'),c=!1,s=i.leftCol,h=!0;s<=i.rightCol;s++)r.columns[s].isVisible&&(h||(u+='\t'),h=!1,f=r.cells.getCellData(o,s,!0).toString(),f=f.replace(/\t/g,' '),(f.indexOf('\n')>-1||f.indexOf('"')>-1)&&(f='"'+f.replace(/"/g,'""')+'"'),u+=f);return u},r.prototype.setClipString=function(i,r){var h=this,u=this._g,l=r==null;if(!r){r=u.selection;switch(u.selectionMode){case t.SelectionMode.Row:case t.SelectionMode.RowRange:case t.SelectionMode.ListBox:r.col=0;r.col2=u.columns.length-1}}r=n.asType(r,t.CellRange);i=n.asString(i).replace(/\r\n/g,'\n').replace(/\r/g,'\n');i&&i[i.length-1]=='\n'&&(i=i.substring(0,i.length-1));l&&!r.isSingleCell&&(i=this._expandClipString(i,r));var o=new t.CellRange(r.topRow,r.leftCol),e=u.editableCollectionView,f=r.topRow,c=this._clipToRows(i),a=!1,s;u.deferUpdate(function(){var i,v,n,l;for(e&&e.beginUpdate(),i=0;i<c.length&&f<u.rows.length;i++,f++){if(!u.rows[f].isVisible){i--;continue}for(v=h._clipToCells(c[i]),n=r.leftCol,l=0;l<v.length&&n<u.columns.length;l++,n++){if(!u.columns[n].isVisible){l--;continue}if(h._allowEditing(f,n)){if(s=new t.CellRangeEventArgs(u.cells,new t.CellRange(f,n),v[l]),u.onPastingCell(s)&&(e&&(e.editItem(u.rows[f].dataItem),h._edItem=e.currentEditItem),u.cells.setCellData(f,n,s.data))){u.onPastedCell(s);a=!0}o.row2=Math.max(o.row2,f);o.col2=Math.max(o.col2,n)}}}e&&e.endUpdate();u.select(o)})},r.prototype._clipToRows=function(n){for(var r=[],i=0,u=!1,t=0;t<n.length;t++)switch(n[t]){case'"':u=!u;break;case'\n':u||(r.push(n.substr(i,t-i)),i=t+1)}return r.push(n.substr(i)),r},r.prototype._clipToCells=function(n){for(var t,u,i=n.split('\t'),r=0;r<i.length;r++)t=i[r],u=t.length,u>1&&t[0]=='"'&&t[u-1]=='"'&&(t=t.substr(1,u-2),t=t.replace(/""/g,'"')),i[r]=t;return i},r.prototype._expandClipString=function(n,t){var s,i,r;if(!n)return n;var h=n.split('\n'),o=h.length,e=0,c=[];for(i=0;i<o;i++){if(s=h[i].split('\t'),c.push(s),i>1&&s.length!=e)return n;e=s.length}var l=this._g,u=0,f=0;for(i=t.topRow;i<=t.bottomRow;i++)l.rows[i].isVisible&&u++;for(r=t.leftCol;r<=t.rightCol;r++)l.columns[r].isVisible&&f++;if((u>1||f>1)&&(u==1&&(u=o),f==1&&(f=e),f%e==0&&u%o==0))for(n='',i=0;i<u;i++)for(r=0;r<f;r++)i>0&&r==0&&(n+='\n'),r>0&&(n+='\t'),n+=c[i%o][r%e];return n},r.prototype._updateEditorCell=function(n,i,r){var u=this._g,f=u.cells.getCellElement(n,i),s=u._useFrozenDiv()&&(n<u.frozenRows||i<u.frozenColumns);if(!f||s||u._hasPendingUpdates())u.refresh(!1);else if(this._updateCell(f),r=r||u._getShowErrors(),r&&u.headersVisibility&t.HeadersVisibility.Row){var e=u.rowHeaders,h=e.columns.length-1,o=e.getCellElement(n,h);o&&this._updateCell(o)}},r.prototype._updateCell=function(n){var i=new t.HitTestInfo(n,null);i.panel&&(n.classList.add(t.FlexGrid._WJS_UPDATING),i.grid.cellFactory.updateCell(i.panel,i.row,i.col,n,i.range),n.classList.remove(t.FlexGrid._WJS_UPDATING))},r.prototype._getValidationError=function(){var n=this._g,r;if(n._getShowErrors()){var t=this._rng.row,i=this._rng.col,u=n.cellFactory.getEditorValue(n),f=n.getCellData(t,i,!1);if(n.setCellData(t,i,u,!0,!1))return r=n._getError(n.cells,t,i),n.setCellData(t,i,f,!0,!1),r}return null},r.prototype._allowEditing=function(n,i){var r=this._g,u;return r.isReadOnly||r.selectionMode==t.SelectionMode.None?!1:n<0||n>=r.rows.length||r.rows[n].isReadOnly||!r.rows[n].isVisible?!1:i<0||i>=r.columns.length?!1:(u=r._getBindingColumn(r.cells,n,r.columns[i]),!u||u.isReadOnly||!u.isVisible)?!1:!0},r.prototype._commitRowEdits=function(){var n=this._g,i,r;if(this.finishEditing()&&this._edItem){if(i=n.editableCollectionView,i&&i.currentEditItem){r=new t.CellRangeEventArgs(n.cells,n.selection);n.onRowEditEnding(r);i.commitEdit();n.onRowEditEnded(r)}this._edItem=null}},r.prototype._keydown=function(t){switch(t.keyCode){case n.Key.F2:return this._fullEdit=!this._fullEdit,t.preventDefault(),!0;case n.Key.F4:return this._toggleListBox(t),t.preventDefault(),!0;case n.Key.Space:var i=this._edt;return!i||i.type!='checkbox'||i.disabled||i.readOnly||(i.checked=!i.checked,this.finishEditing(),t.preventDefault()),!0;case n.Key.Enter:case n.Key.Tab:return t.preventDefault(),!this.finishEditing();case n.Key.Escape:return t.preventDefault(),this.finishEditing(!0),!0;case n.Key.Up:case n.Key.Down:case n.Key.Left:case n.Key.Right:case n.Key.PageUp:case n.Key.PageDown:case n.Key.Home:case n.Key.End:if(this._lbx)return this._keydownListBox(t);if(t.altKey)switch(t.keyCode){case n.Key.Up:case n.Key.Down:return this._toggleListBox(t),t.preventDefault(),!0}if(!this._fullEdit&&this.finishEditing())return!1}return!0},r.prototype._keydownListBox=function(t){var i=!0;if(this._lbx)switch(t.keyCode){case n.Key.Up:t.altKey?this._toggleListBox(t):this._lbx.selectedIndex>0&&this._lbx.selectedIndex--;break;case n.Key.Down:t.altKey?this._toggleListBox(t):this._lbx.selectedIndex++;break;case n.Key.Home:case n.Key.PageUp:this._lbx.selectedIndex=0;break;case n.Key.End:case n.Key.PageDown:this._lbx.selectedIndex=this._lbx.collectionView.items.length-1;break;default:i=!1}return i?(t.preventDefault(),!0):!1},r.prototype._keypress=function(t){var i=this._edt,f,u,r;if(i&&i.type!='checkbox'&&this._list&&this._list.length>0&&t.charCode>=32)for(f=i.selectionStart,u=i.value.substr(0,f),t.target==i&&(f++,u+=String.fromCharCode(t.charCode)),u=u.toLowerCase(),r=0;r<this._list.length;r++)if(this._list[r].toLowerCase().indexOf(u)==0){i.value=this._list[r];n.setSelectionRange(i,f,this._list[r].length);i.dispatchEvent(this._evtInput);t.preventDefault();break}},r.prototype._toggleListBox=function(t,i){var r=this._g,e=r._selHdl.selection,u,f;return(i||(i=e),this._lbx&&(this._removeListBox(),e.contains(i)))?(r.activeEditor?r.activeEditor.focus():r.containsFocus()||r.focus(),!0):(u=r.isTouching,f=r._getBindingColumn(r.cells,i.row,r.columns[i.col]),!n.input||!f.dataMap||f.showDropDown===!1)?!1:!n.input||!this.startEditing(!0,i.row,i.col,!u,t)?!1:(this._lbx=this._createListBox(),this._lbx.showSelection(),u&&this._lbx.focus(),!0)},r.prototype._createListBox=function(){var f=this,t=this._g,i=this._rng,o=t.rows[i.row],s=t._getBindingColumn(t.cells,i.row,t.columns[i.col]),u=document.createElement('div'),r=new n.input.ListBox(u),e;return u.classList.add('wj-dropdown-panel','wj-grid-listbox'),r.maxHeight=o.renderHeight*4,r.itemsSource=s.dataMap.getDisplayValues(o.dataItem),r.selectedValue=t.activeEditor?t.activeEditor.value:t.getCellData(i.row,i.col,!0),n.addClass(u,s.dropDownCssClass),r.addEventListener(r.hostElement,'click',function(){f._removeListBox();t.focus();f.finishEditing()}),r.lostFocus.addHandler(function(){f._removeListBox()}),r.selectedIndexChanged.addHandler(function(){var i=t.activeEditor;i&&(i.value=f._lbx.selectedValue,i.dispatchEvent(f._evtInput),n.setSelectionRange(i,0,i.value.length))}),e=t.cells.getCellElement(i.row,i.col),e?n.showPopup(u,e,!1,!1,!1):(n.showPopup(u,t.getCellBoundingRect(i.row,i.col)),u[n.Control._OWNR_KEY]=t.hostElement),r},r.prototype._removeListBox=function(){this._lbx&&(n.hidePopup(this._lbx.hostElement,!0),this._lbx.dispose(),this._lbx=null)},r}();t._EditHandler=r})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){'use strict';var r=function(){function r(n){this._nrt=new i;this._g=n;this._keydownBnd=this._keydown.bind(this);this._attach()}return Object.defineProperty(r.prototype,"newRowAtTop",{get:function(){return this._top},set:function(t){t!=this.newRowAtTop&&(this._top=n.asBoolean(t),this.updateNewRowTemplate())},enumerable:!0,configurable:!0}),r.prototype.updateNewRowTemplate=function(){var n=this._g,e=n.editableCollectionView,i=n.rows,o=e&&e.canAddNew&&n.allowAddNew&&!n.isReadOnly,r=i.indexOf(this._nrt),s=this._top?0:i.length-1,f=!1,u;!o&&r>-1?(u=n.selection,u.row==r&&n.select(u.row-1,u.col),i.removeAt(r)):o&&(r<0?f=!0:r!=s&&(i.removeAt(r),f=!0),f&&(this._top?i.insert(0,this._nrt):i.push(this._nrt)),this._nrt&&this._nrt._setFlag(t.RowColFlags.ParentCollapsed,!1))},r.prototype._attach=function(){var n=this._g;n&&(n.beginningEdit.addHandler(this._beginningEdit,this),n.pastingCell.addHandler(this._beginningEdit,this),n.rowEditEnded.addHandler(this._rowEditEnded,this),n.loadedRows.addHandler(this.updateNewRowTemplate,this),n.hostElement.addEventListener('keydown',this._keydownBnd,!0))},r.prototype._detach=function(){var n=this._g;n&&(n.beginningEdit.removeHandler(this._beginningEdit),n.pastingCell.removeHandler(this._beginningEdit),n.rowEditEnded.removeHandler(this._rowEditEnded),n.loadedRows.removeHandler(this.updateNewRowTemplate),n.hostElement.removeEventListener('keydown',this._keydownBnd,!0))},r.prototype._keydown=function(t){t.defaultPrevented||t.keyCode!=n.Key.Escape||this._g.activeEditor==null&&this._top&&this._nrt.dataItem&&(this._nrt.dataItem=null,this._g.invalidate())},r.prototype._beginningEdit=function(t,r){var e,u,f;if(!r.cancel&&(e=this._g.rows[r.row],n.tryCast(e,i)&&(u=this._g.editableCollectionView,u&&u.canAddNew)))if(this._top){if(this._nrt.dataItem==null){var f=null,o=u.sourceCollection,s=u.newItemCreator;f=n.isFunction(s)?s():o&&o.length?new o[0].constructor:{};this._nrt.dataItem=f}}else{f=u.currentAddItem&&u.currentAddItem==e.dataItem?u.currentAddItem:u.addNew();u.moveCurrentTo(f);this.updateNewRowTemplate();this._g.refresh(!0);this._g.onRowAdded(r);r.cancel&&u.cancelNew()}},r.prototype._rowEditEnded=function(n,t){var r=this,i=this._g.editableCollectionView,u=this._nrt.dataItem,e,f;if(i)if(i.isAddingNew)i.commitNew();else if(u&&!t.cancel){this._nrt.dataItem=null;e=i.addNew();for(f in u)e[f]=u[f];this._g.onRowAdded(t);t.cancel?i.cancelNew():i.commitNew();setTimeout(function(){r._g.select(0,r._g.columns.firstVisibleIndex);r.updateNewRowTemplate()},20)}},r}(),i;t._AddNewHandler=r;i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(t.Row);t._NewRowTemplate=i})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){'use strict';var i=function(){function t(t){this._g=t;this._tbx=n.createElement('<input class="wj-grid-editor wj-form-control" wj-part="ime-target"/>');this._cssHidden={position:'fixed',pointerEvents:'none',opacity:0,left:-10,top:-10,width:0};n.setCss(this._tbx,this._cssHidden);t.cells.hostElement.parentElement.appendChild(this._tbx);this._updateImeFocus();var i=t.hostElement;t.addEventListener(this._tbx,'compositionstart',this._compositionstart.bind(this));t.addEventListener(this._tbx,'keydown',this._keydown.bind(this));t.addEventListener(i,'blur',this._updateImeFocus.bind(this),!0);t.addEventListener(i,'focus',this._updateImeFocus.bind(this),!0);t.addEventListener(i,'mousedown',this._mousedown.bind(this),!0);t.addEventListener(i,'mouseup',this._mouseup.bind(this),!0);t.cellEditEnded.addHandler(this._cellEditEnded,this);t.selectionChanged.addHandler(this._updateImeFocus,this)}return t.prototype.dispose=function(){var n=this._g,t=n.hostElement;n.removeEventListener(this._tbx,'compositionstart');n.removeEventListener(t,'blur');n.removeEventListener(t,'focus');n.removeEventListener(t,'mousedown');n.removeEventListener(t,'mouseup');n.cellEditEnded.removeHandler(this._cellEditEnded);n.selectionChanged.removeHandler(this._updateImeFocus);this._tbx.parentElement&&this._tbx.parentElement.removeChild(this._tbx)},t.prototype._cellEditEnded=function(){n.setCss(this._tbx,this._cssHidden);this._tbx.value=''},t.prototype._compositionstart=function(){var t=this._g,i;if(t.activeEditor==null&&(i=t._selHdl.selection,t.startEditing(!1,i.row,i.col,!1))){var u=t.getCellBoundingRect(i.row,i.col),r=t.cells.hostElement,f=t.columns[i.col].pos+r.offsetLeft,e=t.rows[i.row].pos+r.offsetTop;i.row<t.frozenRows&&(e+=r.parentElement.scrollTop);i.col<t.frozenColumns&&(f+=r.parentElement.scrollLeft);n.setCss(this._tbx,{position:'absolute',pointerEvents:'',opacity:'',left:f,top:e,width:u.width-1,height:u.height-1});t._edtHdl._edt=this._tbx}},t.prototype._keydown=function(t){switch(t.keyCode){case n.Key.Up:case n.Key.Down:case n.Key.PageUp:case n.Key.PageDown:this._g._keyHdl._keydown(t)}},t.prototype._mousedown=function(){this._mouseDown=!0;this._updateImeFocus()},t.prototype._mouseup=function(){this._mouseDown=!1;this._updateImeFocus()},t.prototype._updateImeFocus=function(){var i=this._g,r=n.getActiveElement(),t;i.activeEditor||i.isTouching||this._mouseDown||!n.contains(i.hostElement,r)||(t=this._tbx,this._enableIme()?r!=t&&(t.disabled=!1,t.select()):t.disabled=!0)},t.prototype._enableIme=function(){var t=this._g,i=t.selection;return t.canEditCell(i.row,i.col)?t.columns[i.col].dataType==n.DataType.Boolean?!1:!0:!1},t}();t._ImeHandler=i})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={}))