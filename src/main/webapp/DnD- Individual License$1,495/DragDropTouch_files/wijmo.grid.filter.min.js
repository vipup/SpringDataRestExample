/*
    *
    * Wijmo Library 5.20172.328
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends,wijmo;(function(n){var t;(function(n){var t;(function(){'use strict'})(t=n.filter||(n.filter={}))})(t=n.grid||(n.grid={}))})(wijmo||(wijmo={})),function(n){var t;(function(t){var i;(function(i){'use strict';var r=function(){function i(t){this._maxValues=250;this._sortValues=!0;this._col=t;this._bnd=t.binding?new n.Binding(t.binding):null}return Object.defineProperty(i.prototype,"showValues",{get:function(){return this._values},set:function(n){this._values=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"filterText",{get:function(){return this._filterText},set:function(t){this._filterText=n.asString(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxValues",{get:function(){return this._maxValues},set:function(t){this._maxValues=n.asNumber(t,!1,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"uniqueValues",{get:function(){return this._uniqueValues},set:function(t){this._uniqueValues=n.asArray(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sortValues",{get:function(){return this._sortValues},set:function(t){this._sortValues=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataMap",{get:function(){return this._map},set:function(i){this._map=n.asType(i,t.DataMap,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"column",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isActive",{get:function(){return this._values!=null&&Object.keys(this._values).length>0},enumerable:!0,configurable:!0}),i.prototype.apply=function(t){var i=this.column;return!this._bnd||!this._values||!Object.keys(this._values).length?!0:(t=this._bnd.getValue(t),t=this.dataMap?this.dataMap.getDisplayValue(t):i.dataMap?i.dataMap.getDisplayValue(t):n.Globalize.format(t,i.format),this._values[t]!=undefined)},i.prototype.clear=function(){this.showValues=null;this.filterText=null},i.prototype.implementsInterface=function(n){return n=='IColumnFilter'},i}();i.ValueFilter=r})(i=t.filter||(t.filter={}))})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i;(function(t){'use strict';var i=function(i){function r(r,u){var f=i.call(this,r)||this,e,o,s;return f._filter=n.asType(u,t.ValueFilter,!1),e=f.getTemplate(),f.applyTemplate('wj-control',e,{_divFilter:'div-filter',_cbSelectAll:'cb-select-all',_spSelectAll:'sp-select-all',_divValues:'div-values'}),f._spSelectAll.textContent=n.culture.FlexGridFilter.selectAll,f._view=new n.collections.CollectionView,u.sortValues&&(o=u.column.dataMap||u.dataMap?'text':'value',s=u.column.dataType!=n.DataType.Boolean,f._view.sortDescriptions.push(new n.collections.SortDescription(o,s))),f._view.filter=f._filterValues.bind(f),f._view.collectionChanged.addHandler(f._updateSelectAllCheck,f),f._filterText='',f._cmbFilter=new n.input.ComboBox(f._divFilter,{placeholder:n.culture.FlexGridFilter.search}),f._lbValues=new n.input.ListBox(f._divValues,{displayMemberPath:'text',checkedMemberPath:'show',itemsSource:f._view,itemFormatter:function(t,i){return i?i:n.culture.FlexGridFilter.null}}),f._cmbFilter.textChanged.addHandler(f._filterTextChanged,f),f._cbSelectAll.addEventListener('click',f._cbSelectAllClicked.bind(f)),f.updateEditor(),f}return __extends(r,i),Object.defineProperty(r.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),r.prototype.updateEditor=function(){var n=this;setTimeout(function(){n._updateEditor()})},r.prototype._updateEditor=function(){var r=this._filter.column,i=[],h,a,c,u,o,s,v,t;if(this._lbValues.isContentHtml=r.isContentHtml,this._view.pageSize=this._filter.maxValues,this._view.sourceCollection=i,this._filter.uniqueValues)for(h=this._filter.uniqueValues,t=0;t<h.length;t++)u=h[t],i.push({value:u,text:u.toString()});else{var l={},f=r.collectionView?r.collectionView.sourceCollection:[],e=r.collectionView;if(e&&e.sourceCollection&&e.filter){for(a=this._filter.showValues,this._filter.showValues=null,c=[],t=0;t<f.length;t++)e.filter(f[t])&&c.push(f[t]);f=c;this._filter.showValues=a}for(t=0;t<f.length;t++)u=r._binding.getValue(f[t]),o=this._filter.dataMap?this._filter.dataMap.getDisplayValue(u):r.dataMap?r.dataMap.getDisplayValue(u):n.Globalize.format(u,r.format),l[o]||(l[o]=!0,i.push({value:u,text:o}),i.length>5&&this._view.items.length==0&&(this._view.refresh(),this._lbValues.refresh()))}if(s=this._filter.showValues,s&&Object.keys(s).length!=0){for(v in s)for(t=0;t<i.length;t++)if(i[t].text==v){i[t].show=!0;break}}else for(t=0;t<i.length;t++)i[t].show=!0;this._cmbFilter.text=this._filter.filterText;this._filterText=this._cmbFilter.text.toLowerCase();this._view.refresh();this._view.moveCurrentToPosition(-1)},r.prototype.clearEditor=function(){var t,n;for(this._cmbFilter.text='',this._filterText='',this._view.refresh(),t=this._view.items,n=0;n<t.length;n++)t[n].show=!1},r.prototype.updateFilter=function(){var t=null,r=this._view.items,n,i;if(this._filterText||this._cbSelectAll.indeterminate)for(t={},n=0;n<r.length;n++)i=r[n],i.show&&(t[i.text]=!0);this._filter.showValues=t;this._filter.filterText=this._filterText},r.prototype._filterTextChanged=function(){var n=this;this._toText&&clearTimeout(this._toText);this._toText=setTimeout(function(){var t=n._cmbFilter.text.toLowerCase();t!=n._filterText&&(n._filterText=t,n._view.refresh(),n._cbSelectAll.checked=!0,n._cbSelectAllClicked())},500)},r.prototype._filterValues=function(n){return this._filterText?n&&n.text?n.text.toLowerCase().indexOf(this._filterText)>-1:!1:!0},r.prototype._cbSelectAllClicked=function(){for(var i=this._cbSelectAll.checked,t=this._view.items,n=0;n<t.length;n++)t[n].show=i;this._view.refresh()},r.prototype._updateSelectAllCheck=function(){for(var n=0,t=this._view.items,i=0;i<t.length;i++)t[i].show&&n++;n==0?(this._cbSelectAll.checked=!1,this._cbSelectAll.indeterminate=!1):n==t.length?(this._cbSelectAll.checked=!0,this._cbSelectAll.indeterminate=!1):this._cbSelectAll.indeterminate=!0},r}(n.Control);i.controlTemplate='<div><div wj-part="div-filter"><\/div><div class="wj-listbox-item"><label><input wj-part="cb-select-all" type="checkbox"> <span wj-part="sp-select-all"><\/span><\/label><\/div><div wj-part="div-values" style="height:150px"><\/div><\/div>';t.ValueFilterEditor=i})(i=t.filter||(t.filter={}))})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){var i;(function(i){'use strict';var r=function(){function r(t){this._c1=new i.FilterCondition;this._c2=new i.FilterCondition;this._and=!0;this._col=t;this._bnd=t.binding?new n.Binding(t.binding):null}return Object.defineProperty(r.prototype,"condition1",{get:function(){return this._c1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"condition2",{get:function(){return this._c2},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"and",{get:function(){return this._and},set:function(t){this._and=n.asBoolean(t);this._bnd=this._col&&this._col.binding?new n.Binding(this._col.binding):null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataMap",{get:function(){return this._map},set:function(i){this._map=n.asType(i,t.DataMap,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"column",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isActive",{get:function(){return this._c1.isActive||this._c2.isActive},enumerable:!0,configurable:!0}),r.prototype.apply=function(t){var i=this._col,r=this._c1,u=this._c2,f,e;return!this._bnd||!this.isActive?!0:(t=this._bnd.getValue(t),i.dataMap?t=i.dataMap.getDisplayValue(t):n.isDate(t)?(n.isString(r.value)||n.isString(u.value))&&(t=n.Globalize.format(t,i.format)):n.isNumber(t)&&(t=n.Globalize.parseFloat(n.Globalize.format(t,i.format))),f=r.apply(t),e=u.apply(t),r.isActive&&u.isActive?this._and?f&&e:f||e:r.isActive?f:u.isActive?e:!0)},r.prototype.clear=function(){this._c1.clear();this._c2.clear();this.and=!0},r.prototype.implementsInterface=function(n){return n=='IColumnFilter'},r}();i.ConditionFilter=r})(i=t.filter||(t.filter={}))})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i;(function(t){'use strict';var i=function(i){function r(r,u){var f=i.call(this,r)||this,o,e;return f._filter=n.asType(u,t.ConditionFilter,!1),o=f.getTemplate(),f.applyTemplate('wj-control',o,{_divHdr:'div-hdr',_divCmb1:'div-cmb1',_divVal1:'div-val1',_btnAnd:'btn-and',_btnOr:'btn-or',_spAnd:'sp-and',_spOr:'sp-or',_divCmb2:'div-cmb2',_divVal2:'div-val2'}),f._divHdr.textContent=n.culture.FlexGridFilter.header,f._spAnd.textContent=n.culture.FlexGridFilter.and,f._spOr.textContent=n.culture.FlexGridFilter.or,f._cmb1=f._createOperatorCombo(f._divCmb1),f._cmb2=f._createOperatorCombo(f._divCmb2),f._val1=f._createValueInput(f._divVal1),f._val2=f._createValueInput(f._divVal2),e=f._btnAndOrChanged.bind(f),f._btnAnd.addEventListener('change',e),f._btnOr.addEventListener('change',e),f.updateEditor(),f}return __extends(r,i),Object.defineProperty(r.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),r.prototype.updateEditor=function(){var t=this._filter.condition1,i=this._filter.condition2;this._cmb1.selectedValue=t.operator;this._cmb2.selectedValue=i.operator;this._val1 instanceof n.input.ComboBox?(this._val1.text=n.changeType(t.value,n.DataType.String,null),this._val2.text=n.changeType(i.value,n.DataType.String,null)):(this._val1.value=t.value,this._val2.value=i.value);this._btnAnd.checked=this._filter.and;this._btnOr.checked=!this._filter.and},r.prototype.clearEditor=function(){this._cmb1.selectedValue=this._cmb2.selectedValue=null;this._val1.text=this._val2.text=null;this._btnAnd.checked=!0;this._btnOr.checked=!1},r.prototype.updateFilter=function(){var t=this._filter.column,i=this._filter.condition1,r=this._filter.condition2,u;i.operator=this._cmb1.selectedValue;r.operator=this._cmb2.selectedValue;this._val1 instanceof n.input.ComboBox?(u=t.dataType==n.DataType.Date?n.DataType.String:t.dataType,i.value=n.changeType(this._val1.text,u,t.format),r.value=n.changeType(this._val2.text,u,t.format)):(i.value=this._val1.value,r.value=this._val2.value);this._filter.and=this._btnAnd.checked},r.prototype._createOperatorCombo=function(t){var i=this._filter.column,u=n.culture.FlexGridFilter.stringOperators,r;return i.dataType!=n.DataType.Date||this._isTimeFormat(i.format)?i.dataType!=n.DataType.Number||i.dataMap?i.dataType!=n.DataType.Boolean||i.dataMap||(u=n.culture.FlexGridFilter.booleanOperators):u=n.culture.FlexGridFilter.numberOperators:u=n.culture.FlexGridFilter.dateOperators,r=new n.input.ComboBox(t),r.itemsSource=u,r.displayMemberPath='name',r.selectedValuePath='op',r},r.prototype._createValueInput=function(t){var i=this._filter.column,r=null;return i.dataType!=n.DataType.Date||this._isTimeFormat(i.format)?i.dataType!=n.DataType.Number||i.dataMap?(r=new n.input.ComboBox(t),r.itemsSource=this._filter.dataMap?this._filter.dataMap.getDisplayValues():i.dataMap?i.dataMap.getDisplayValues():i.dataType==n.DataType.Boolean?[!0,!1]:null):(r=new n.input.InputNumber(t),r.format=i.format):(r=new n.input.InputDate(t),r.format=i.format),r.isRequired=!1,r},r.prototype._isTimeFormat=function(t){return t?(t=n.culture.Globalize.calendar.patterns[t]||t,/[Hmst]+/.test(t)):!1},r.prototype._btnAndOrChanged=function(n){this._btnAnd.checked=n.target==this._btnAnd;this._btnOr.checked=n.target==this._btnOr},r}(n.Control);i.controlTemplate='<div><div wj-part="div-hdr"><\/div><div wj-part="div-cmb1"><\/div><br/><div wj-part="div-val1"><\/div><br/><div style="text-align:center"><label><input wj-part="btn-and" type="radio"> <span wj-part="sp-and"><\/span> <\/label>&nbsp;&nbsp;&nbsp;<label><input wj-part="btn-or" type="radio"> <span wj-part="sp-or"><\/span> <\/label><\/div><div wj-part="div-cmb2"><\/div><br/><div wj-part="div-val2"><\/div><br/><\/div>';t.ConditionFilterEditor=i})(i=t.filter||(t.filter={}))})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){var i;(function(t){'use strict';var r=function(){function t(){this._op=null}return Object.defineProperty(t.prototype,"operator",{get:function(){return this._op},set:function(t){this._op=n.asEnum(t,i,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._val},set:function(t){this._val=t;this._strVal=n.isString(t)?t.toString().toLowerCase():null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){switch(this._op){case null:return!1;case i.EQ:case i.NE:return!0;default:return this._val!=null||this._strVal!=null}},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this.operator=null;this.value=null},t.prototype.apply=function(t){var r=this._strVal||this._val;n.isString(t)&&(t=t.toLowerCase());switch(this._op){case null:return!0;case i.EQ:return n.isDate(t)&&n.isDate(r)?n.DateTime.sameDate(t,r):t==r;case i.NE:return t!=r;case i.GT:return t>r;case i.GE:return t>=r;case i.LT:return t<r;case i.LE:return t<=r;case i.BW:return this._strVal&&n.isString(t)?t.indexOf(this._strVal)==0:!1;case i.EW:return this._strVal&&n.isString(t)&&t.length>=this._strVal.length?t.substr(t.length-this._strVal.length)==r:!1;case i.CT:return this._strVal&&n.isString(t)?t.indexOf(this._strVal)>-1:!1;case i.NC:return this._strVal&&n.isString(t)?t.indexOf(this._strVal)<0:!1}throw'Unknown operator';},t}(),i;t.FilterCondition=r,function(n){n[n.EQ=0]="EQ";n[n.NE=1]="NE";n[n.GT=2]="GT";n[n.GE=3]="GE";n[n.LT=4]="LT";n[n.LE=5]="LE";n[n.BW=6]="BW";n[n.EW=7]="EW";n[n.CT=8]="CT";n[n.NC=9]="NC"}(i=t.Operator||(t.Operator={}))})(i=t.filter||(t.filter={}))})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){var i;(function(t){'use strict';var i=function(){function i(n,i){this._owner=n;this._col=i;this._valueFilter=new t.ValueFilter(i);this._conditionFilter=new t.ConditionFilter(i)}return Object.defineProperty(i.prototype,"filterType",{get:function(){return this._filterType!=null?this._filterType:this._owner.defaultFilterType},set:function(i){if(i!=this._filterType){var r=this.isActive;this.clear();this._filterType=n.asEnum(i,t.FilterType,!0);r?this._owner.apply():this._col.grid&&this._col.grid.invalidate()}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataMap",{get:function(){return this.conditionFilter.dataMap||this.valueFilter.dataMap},set:function(n){this.conditionFilter.dataMap=n;this.valueFilter.dataMap=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"valueFilter",{get:function(){return this._valueFilter},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"conditionFilter",{get:function(){return this._conditionFilter},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"column",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isActive",{get:function(){return this._conditionFilter.isActive||this._valueFilter.isActive},enumerable:!0,configurable:!0}),i.prototype.apply=function(n){return this._conditionFilter.apply(n)&&this._valueFilter.apply(n)},i.prototype.clear=function(){this._valueFilter.clear();this._conditionFilter.clear()},i.prototype.implementsInterface=function(n){return n=='IColumnFilter'},i}();t.ColumnFilter=i})(i=t.filter||(t.filter={}))})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i;(function(t){'use strict';n.culture.FlexGridFilter=window.wijmo.culture.FlexGridFilter||{ascending:'\u2191 Ascending',descending:'\u2193 Descending',apply:'Apply',clear:'Clear',conditions:'Filter by Condition',values:'Filter by Value',search:'Search',selectAll:'Select All',null:'(nothing)',header:'Show items where the value',and:'And',or:'Or',stringOperators:[{name:'(not set)',op:null},{name:'Equals',op:t.Operator.EQ},{name:'Does not equal',op:t.Operator.NE},{name:'Begins with',op:t.Operator.BW},{name:'Ends with',op:t.Operator.EW},{name:'Contains',op:t.Operator.CT},{name:'Does not contain',op:t.Operator.NC}],numberOperators:[{name:'(not set)',op:null},{name:'Equals',op:t.Operator.EQ},{name:'Does not equal',op:t.Operator.NE},{name:'Is Greater than',op:t.Operator.GT},{name:'Is Greater than or equal to',op:t.Operator.GE},{name:'Is Less than',op:t.Operator.LT},{name:'Is Less than or equal to',op:t.Operator.LE}],dateOperators:[{name:'(not set)',op:null},{name:'Equals',op:t.Operator.EQ},{name:'Is Before',op:t.Operator.LT},{name:'Is After',op:t.Operator.GT}],booleanOperators:[{name:'(not set)',op:null},{name:'Equals',op:t.Operator.EQ},{name:'Does not equal',op:t.Operator.NE}]};var i=function(i){function r(r,u,f){var e,h,c,l,s,o;return f===void 0&&(f=!0),e=i.call(this,r,null,!0)||this,e.filterChanged=new n.Event,e.buttonClicked=new n.Event,e._filter=n.asType(u,t.ColumnFilter),h=e.getTemplate(),e.applyTemplate('wj-control wj-columnfiltereditor wj-content',h,{_divSort:'div-sort',_btnAsc:'btn-asc',_btnDsc:'btn-dsc',_divType:'div-type',_aVal:'a-val',_aCnd:'a-cnd',_divEdtVal:'div-edt-val',_divEdtCnd:'div-edt-cnd',_btnApply:'btn-apply',_btnClear:'btn-clear'}),e._btnAsc.textContent=n.culture.FlexGridFilter.ascending,e._btnDsc.textContent=n.culture.FlexGridFilter.descending,e._aVal.textContent=n.culture.FlexGridFilter.values,e._aCnd.textContent=n.culture.FlexGridFilter.conditions,e._btnApply.textContent=n.culture.FlexGridFilter.apply,e._btnClear.textContent=n.culture.FlexGridFilter.clear,c=e.filter.conditionFilter.isActive||(u.filterType&t.FilterType.Value)==0?t.FilterType.Condition:t.FilterType.Value,e._showFilter(c),l=e.filter.column,s=l.grid.collectionView,f&&s&&s.canSort||(e._divSort.style.display='none'),o=e._btnClicked.bind(e),e._btnApply.addEventListener('click',o),e._btnClear.addEventListener('click',o),e._btnAsc.addEventListener('click',o),e._btnDsc.addEventListener('click',o),e._aVal.addEventListener('click',o),e._aCnd.addEventListener('click',o),e.hostElement.addEventListener('keydown',function(t){switch(t.keyCode){case n.Key.Enter:switch(t.target.tagName){case'A':case'BUTTON':e._btnClicked(t);break;default:e.updateFilter();e.onFilterChanged();e.onButtonClicked()}t.preventDefault();break;case n.Key.Escape:e.onButtonClicked();t.preventDefault()}}),e}return __extends(r,i),Object.defineProperty(r.prototype,"filter",{get:function(){return this._filter},enumerable:!0,configurable:!0}),r.prototype.updateEditor=function(){this._edtVal&&this._edtVal.updateEditor();this._edtCnd&&this._edtCnd.updateEditor()},r.prototype.updateFilter=function(){switch(this._getFilterType()){case t.FilterType.Value:this._edtVal.updateFilter();this.filter.conditionFilter.clear();break;case t.FilterType.Condition:this._edtCnd.updateFilter();this.filter.valueFilter.clear()}},r.prototype.onFilterChanged=function(n){this.filterChanged.raise(this,n)},r.prototype.onButtonClicked=function(n){this.buttonClicked.raise(this,n)},r.prototype._handleResize=function(){this.onButtonClicked()},r.prototype._showFilter=function(n){n==t.FilterType.Value&&this._edtVal==null&&(this._edtVal=new t.ValueFilterEditor(this._divEdtVal,this.filter.valueFilter));n==t.FilterType.Condition&&this._edtCnd==null&&(this._edtCnd=new t.ConditionFilterEditor(this._divEdtCnd,this.filter.conditionFilter));(n&this.filter.filterType)!=0&&(n==t.FilterType.Value?(this._divEdtVal.style.display='',this._divEdtCnd.style.display='none',this._enableLink(this._aVal,!1),this._enableLink(this._aCnd,!0),this._edtVal.focus()):(this._divEdtVal.style.display='none',this._divEdtCnd.style.display='',this._enableLink(this._aVal,!0),this._enableLink(this._aCnd,!1),this._edtCnd.focus()));switch(this.filter.filterType){case t.FilterType.None:case t.FilterType.Condition:case t.FilterType.Value:this._divType.style.display='none';break;default:this._divType.style.display=''}},r.prototype._enableLink=function(t,i){t.style.textDecoration=i?'':'none';t.style.fontWeight=i?'':'bold';n.setAttribute(t,'href',i?'':null)},r.prototype._getFilterType=function(){return this._divEdtVal.style.display!='none'?t.FilterType.Value:t.FilterType.Condition},r.prototype._btnClicked=function(i){if(i.preventDefault(),i.stopPropagation(),!n.hasClass(i.target,'wj-state-disabled')){if(i.target==this._aVal){this._showFilter(t.FilterType.Value);return}if(i.target==this._aCnd){this._showFilter(t.FilterType.Condition);return}if(i.target==this._btnAsc||i.target==this._btnDsc){var r=this.filter.column,f=r.sortMemberPath?r.sortMemberPath:r.binding,u=r.grid.collectionView,e=new n.collections.SortDescription(f,i.target==this._btnAsc);u.sortDescriptions.deferUpdate(function(){u.sortDescriptions.clear();u.sortDescriptions.push(e)})}i.target==this._btnApply?(this.updateFilter(),this.onFilterChanged()):i.target==this._btnClear?this.filter.isActive&&(this.filter.clear(),this.onFilterChanged()):this.updateEditor();this.onButtonClicked()}},r}(n.Control);i.controlTemplate='<div><div wj-part="div-sort"><a wj-part="btn-asc" href="" style="min-width:95px" draggable="false"><\/a>&nbsp;&nbsp;&nbsp;<a wj-part="btn-dsc" href="" style="min-width:95px" draggable="false"><\/a><\/div><div style="text-align:right;margin:10px 0px;font-size:80%"><div wj-part="div-type"><a wj-part="a-cnd" href="" draggable="false"><\/a>&nbsp;|&nbsp;<a wj-part="a-val" href="" draggable="false"><\/a><\/div><\/div><div wj-part="div-edt-val"><\/div><div wj-part="div-edt-cnd"><\/div><div style="text-align:right;margin-top:10px"><a wj-part="btn-apply" href="" draggable="false"><\/a>&nbsp;&nbsp;<a wj-part="btn-clear" href="" draggable="false"><\/a><\/div>';t.ColumnFilterEditor=i})(i=t.filter||(t.filter={}))})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={})),function(n){var t;(function(t){var i;(function(i){'use strict';var r,u;(function(n){n[n.None=0]="None";n[n.Condition=1]="Condition";n[n.Value=2]="Value";n[n.Both=3]="Both"})(r=i.FilterType||(i.FilterType={}));u=function(){function u(i){var f,u;this._showIcons=!0;this._showSort=!0;this._defFilterType=r.Both;this.filterApplied=new n.Event;this.filterChanging=new n.Event;this.filterChanged=new n.Event;f='Missing dependency: FlexGridFilter requires ';n.assert(n.grid!=null,f+'wijmo.grid.');n.assert(n.input!=null,f+'wijmo.input.');this._filters=[];this._g=n.asType(i,t.FlexGrid,!1);this._g.formatItem.addHandler(this._formatItem.bind(this));this._g.itemsSourceChanged.addHandler(this.clear.bind(this));u=this._g.hostElement;u.addEventListener('mousedown',this._mousedown.bind(this),!0);u.addEventListener('click',this._click.bind(this),!0);u.addEventListener('keydown',this._keydown.bind(this),!0);this._g.invalidate()}return Object.defineProperty(u.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"filterColumns",{get:function(){return this._filterColumns},set:function(t){this._filterColumns=n.asArray(t);this.clear()},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showFilterIcons",{get:function(){return this._showIcons},set:function(t){t!=this.showFilterIcons&&(this._showIcons=n.asBoolean(t),this._g&&this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showSortButtons",{get:function(){return this._showSort},set:function(t){this._showSort=n.asBoolean(t)},enumerable:!0,configurable:!0}),u.prototype.getColumnFilter=function(n,t){var r,u;for(t===void 0&&(t=!0),n=this._asColumn(n),r=0;r<this._filters.length;r++)if(this._filters[r].column==n)return this._filters[r];return t&&n.binding?(u=new i.ColumnFilter(this,n),this._filters.push(u),u):null},Object.defineProperty(u.prototype,"defaultFilterType",{get:function(){return this._defFilterType},set:function(t){t!=this.defaultFilterType&&(this._defFilterType=n.asEnum(t,r,!1),this._g.invalidate(),this.clear())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"filterDefinition",{get:function(){for(var n,t,u,i={defaultFilterType:this.defaultFilterType,filters:[]},r=0;r<this._filters.length;r++)n=this._filters[r],n&&n.column&&n.column.binding&&(n.conditionFilter.isActive?(t=n.conditionFilter,i.filters.push({binding:n.column.binding,type:'condition',condition1:{operator:t.condition1.operator,value:t.condition1.value},and:t.and,condition2:{operator:t.condition2.operator,value:t.condition2.value}})):n.valueFilter.isActive&&(u=n.valueFilter,i.filters.push({binding:n.column.binding,type:'value',filterText:u.filterText,showValues:u.showValues})));return JSON.stringify(i)},set:function(t){var f,e,r,s;if(t=n.asString(t),this.clear(),t)for(f=JSON.parse(t),this.defaultFilterType=f.defaultFilterType,e=0;e<f.filters.length;e++){var i=f.filters[e],u=this._g.getColumn(i.binding),o=this.getColumnFilter(u,!0);if(o)switch(i.type){case'condition':r=o.conditionFilter;r.condition1.value=u.dataType==n.DataType.Date?n.changeType(i.condition1.value,u.dataType,null):i.condition1.value;r.condition1.operator=i.condition1.operator;r.and=i.and;r.condition2.value=u.dataType==n.DataType.Date?n.changeType(i.condition2.value,u.dataType,null):i.condition2.value;r.condition2.operator=i.condition2.operator;break;case'value':s=o.valueFilter;s.filterText=i.filterText;s.showValues=i.showValues}}this.apply()},enumerable:!0,configurable:!0}),u.prototype.editColumnFilter=function(r,u){var e=this,f;this.closeEditor();r=this._asColumn(r);f=new t.CellRangeEventArgs(this._g.cells,new t.CellRange(-1,r.index));this.onFilterChanging(f);if(!f.cancel){f.cancel=!0;var o=document.createElement('div'),a=this.getColumnFilter(r),h=new i.ColumnFilterEditor(o,a,this.showSortButtons);n.addClass(o,'wj-dropdown-panel');this._g.rightToLeft&&(o.dir='rtl');h.filterChanged.addHandler(function(){f.cancel=!1;setTimeout(function(){f.cancel||e.apply()})});h.buttonClicked.addHandler(function(){e.closeEditor();e._g.focus();e.onFilterChanged(f)});h.lostFocus.addHandler(function(){setTimeout(function(){var t=n.Control.getControl(e._divEdt);t&&!t.containsFocus()&&e.closeEditor()},10)});var l=this._g.columnHeaders,v=u?u.row:l.rows.length-1,y=u?u.col:r.index,s=l.getCellBoundingRect(v,y),c=document.elementFromPoint(s.left+s.width/2,s.top+s.height/2);c=n.closest(c,'.wj-cell');c?n.showPopup(o,c,!1,!1,!1):n.showPopup(o,s);h.focus();this._divEdt=o;this._edtCol=r}},u.prototype.closeEditor=function(){if(this._divEdt){n.hidePopup(this._divEdt,!0);var t=n.Control.getControl(this._divEdt);t&&t.dispose();this._divEdt=null;this._edtCol=null}},u.prototype.apply=function(){var t=this._g.collectionView,i,r;t&&(i=this._g.editableCollectionView,i&&(i.commitEdit(),i.commitNew()),t.filter?t.refresh():t.filter=this._filter.bind(this));r=t?t.updateFilterDefinition:null;n.isFunction(r)&&r.call(t,this);this.onFilterApplied()},u.prototype.clear=function(){this._filters.length&&(this._filters=[],this.apply())},u.prototype.onFilterApplied=function(n){this.filterApplied.raise(this,n)},u.prototype.onFilterChanging=function(n){this.filterChanging.raise(this,n)},u.prototype.onFilterChanged=function(n){this.filterChanged.raise(this,n)},u.prototype._asColumn=function(i){return n.isString(i)?this._g.getColumn(i):n.isNumber(i)?this._g.columns[i]:n.asType(i,t.Column,!1)},u.prototype._filter=function(n){for(var t=0;t<this._filters.length;t++)if(!this._filters[t].apply(n))return!1;return!0},u.prototype._formatItem=function(i,f){var e,o,a;if(f.panel.cellType==t.CellType.ColumnHeader){var s=this._g,c=s.getMergedRange(f.panel,f.row,f.col)||new t.CellRange(f.row,f.col),l=s.columns[c.col],h=s._getBindingColumn(f.panel,f.row,l);(c.row2==f.panel.rows.length-1||l!=h)&&(e=this.getColumnFilter(h,this.defaultFilterType!=r.None),this._filterColumns&&this._filterColumns.indexOf(h.binding)<0&&(e=null),e&&e.filterType!=r.None?(this._showIcons&&(u._filterGlyph||(u._filterGlyph=n.createElement('<div role="button" class="'+u._WJC_FILTER+'"><span class="wj-glyph-filter"><\/span><\/div> ')),o=f.cell.querySelector('div')||f.cell,a=o.querySelector('.wj-glyph-filter'),a||o.insertBefore(u._filterGlyph.cloneNode(!0),o.firstChild)),n.toggleClass(f.cell,'wj-filter-on',e.isActive),n.toggleClass(f.cell,'wj-filter-off',!e.isActive)):(n.removeClass(f.cell,'wj-filter-on'),n.removeClass(f.cell,'wj-filter-off')))}},u.prototype._mousedown=function(n){this._toggleEditor(n)&&(this._tmd=!0,n.stopPropagation(),n.preventDefault())},u.prototype._click=function(n){(this._tmd||this._toggleEditor(n))&&(n.stopPropagation(),n.preventDefault());this._tmd=!1},u.prototype._toggleEditor=function(i){var s=this,f,r,o,e;return(this._tmd=!1,!i.defaultPrevented&&i.button==0&&n.closest(i.target,'.'+u._WJC_FILTER)&&(f=this._g,r=new t.HitTestInfo(i.target,null),r.panel==f.columnHeaders))?(o=f.columns[r.col],e=f._getBindingColumn(r.panel,r.row,o),this._divEdt&&this._edtCol==e?this.closeEditor():setTimeout(function(){s.editColumnFilter(e,r)},this._divEdt?100:0),!0):!1},u.prototype._keydown=function(t){if(!t.defaultPrevented&&!t.ctrlKey&&t.altKey&&t.keyCode==n.Key.Down){var r=this.grid.selection,i=r.col>-1?this.grid.columns[r.col]:null;i&&!i.dataMap&&this.getColumnFilter(i,!0)&&(this.editColumnFilter(i),t.preventDefault(),t.stopPropagation())}},u}();u._WJC_FILTER='wj-elem-filter';i.FlexGridFilter=u})(i=t.filter||(t.filter={}))})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={}))